[0m23:47:33.794743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018109663320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810C747770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810C747710>]}


============================== 23:47:33.800743 | 53a99c4c-9a37-4203-89b1-f109b9420d26 ==============================
[0m23:47:33.800743 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m23:47:33.801744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:47:34.406454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810CA9B950>]}
[0m23:47:34.494452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810CAC5460>]}
[0m23:47:34.496453 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:47:34.508503 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m23:47:34.510517 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:47:34.511517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810CE4D5E0>]}
[0m23:47:36.209499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810E1534A0>]}
[0m23:47:36.344466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810E157AD0>]}
[0m23:47:36.346468 [info ] [MainThread]: Found 3 models, 4 data tests, 428 macros
[0m23:47:36.347454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810E0FEC30>]}
[0m23:47:36.350464 [info ] [MainThread]: 
[0m23:47:36.351454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:47:36.352455 [info ] [MainThread]: 
[0m23:47:36.353453 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:36.358453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m23:47:36.587591 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m23:47:36.588551 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m23:47:36.589074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:36.648230 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.059 seconds
[0m23:47:36.650214 [debug] [ThreadPool]: On list_qms: Close
[0m23:47:36.651212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_qms, now create_qms_qms)
[0m23:47:36.652215 [debug] [ThreadPool]: Creating schema "database: "qms"
schema: "qms"
"
[0m23:47:36.660212 [debug] [ThreadPool]: Using postgres connection "create_qms_qms"
[0m23:47:36.660212 [debug] [ThreadPool]: On create_qms_qms: BEGIN
[0m23:47:36.661213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:36.710214 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m23:47:36.711229 [debug] [ThreadPool]: Using postgres connection "create_qms_qms"
[0m23:47:36.711229 [debug] [ThreadPool]: On create_qms_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "create_qms_qms"} */
create schema if not exists "qms"
[0m23:47:36.715214 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m23:47:36.717212 [debug] [ThreadPool]: On create_qms_qms: COMMIT
[0m23:47:36.718214 [debug] [ThreadPool]: Using postgres connection "create_qms_qms"
[0m23:47:36.718214 [debug] [ThreadPool]: On create_qms_qms: COMMIT
[0m23:47:36.719213 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:47:36.720214 [debug] [ThreadPool]: On create_qms_qms: Close
[0m23:47:36.723221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_qms'
[0m23:47:36.731217 [debug] [ThreadPool]: Using postgres connection "list_qms_qms"
[0m23:47:36.732215 [debug] [ThreadPool]: On list_qms_qms: BEGIN
[0m23:47:36.732215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:36.787213 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m23:47:36.788214 [debug] [ThreadPool]: Using postgres connection "list_qms_qms"
[0m23:47:36.789213 [debug] [ThreadPool]: On list_qms_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_qms"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'qms'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'qms'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'qms'
  
[0m23:47:36.795216 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m23:47:36.797214 [debug] [ThreadPool]: On list_qms_qms: ROLLBACK
[0m23:47:36.798214 [debug] [ThreadPool]: On list_qms_qms: Close
[0m23:47:36.808215 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:36.808215 [debug] [MainThread]: On master: BEGIN
[0m23:47:36.809213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:36.869214 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m23:47:36.870219 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:36.871215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:36.880217 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:47:36.882216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810A054E90>]}
[0m23:47:36.883215 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:36.884214 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:36.885215 [debug] [MainThread]: On master: BEGIN
[0m23:47:36.886216 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:47:36.887215 [debug] [MainThread]: On master: COMMIT
[0m23:47:36.887215 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:36.888214 [debug] [MainThread]: On master: COMMIT
[0m23:47:36.889215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:47:36.890218 [debug] [MainThread]: On master: Close
[0m23:47:36.895215 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.my_first_dbt_model
[0m23:47:36.896215 [info ] [Thread-1 (]: 1 of 3 START sql table model qms.my_first_dbt_model ............................ [RUN]
[0m23:47:36.898215 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.my_first_dbt_model'
[0m23:47:36.899216 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.my_first_dbt_model
[0m23:47:36.969212 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.my_first_dbt_model"
[0m23:47:36.971222 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.my_first_dbt_model
[0m23:47:37.023213 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.my_first_dbt_model"
[0m23:47:37.026213 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_first_dbt_model"
[0m23:47:37.027213 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_first_dbt_model: BEGIN
[0m23:47:37.028214 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:47:37.079213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m23:47:37.080215 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_first_dbt_model"
[0m23:47:37.081214 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.my_first_dbt_model"} */

  
    

  create  table "qms"."qms"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m23:47:37.088223 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m23:47:37.097214 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_first_dbt_model"
[0m23:47:37.098214 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.my_first_dbt_model"} */
alter table "qms"."qms"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:47:37.101223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:47:37.123265 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_first_dbt_model: COMMIT
[0m23:47:37.124252 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_first_dbt_model"
[0m23:47:37.125247 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_first_dbt_model: COMMIT
[0m23:47:37.126300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:47:37.134251 [debug] [Thread-1 (]: Applying DROP to: "qms"."qms"."my_first_dbt_model__dbt_backup"
[0m23:47:37.142279 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_first_dbt_model"
[0m23:47:37.142279 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.my_first_dbt_model"} */
drop table if exists "qms"."qms"."my_first_dbt_model__dbt_backup" cascade
[0m23:47:37.144216 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:47:37.147252 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_first_dbt_model: Close
[0m23:47:37.150214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018109F96FC0>]}
[0m23:47:37.151214 [info ] [Thread-1 (]: 1 of 3 OK created sql table model qms.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.25s]
[0m23:47:37.153214 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.my_first_dbt_model
[0m23:47:37.154228 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m23:47:37.155238 [info ] [Thread-1 (]: 2 of 3 START sql view model qms.queue_summary .................................. [RUN]
[0m23:47:37.156252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Analytics_ETL_Model.my_first_dbt_model, now model.Analytics_ETL_Model.queue_summary)
[0m23:47:37.157260 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m23:47:37.160215 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m23:47:37.162216 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m23:47:37.191280 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m23:47:37.193214 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:47:37.194215 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m23:47:37.194215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:37.250214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m23:47:37.251214 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:47:37.252214 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

  create view "qms"."qms"."queue_summary__dbt_tmp"
    
    
  as (
    WITH daily_reservations AS (
    SELECT
        queue_id,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id
  );
[0m23:47:37.259213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:47:37.266252 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:47:37.267232 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."qms"."queue_summary__dbt_tmp" rename to "queue_summary"
[0m23:47:37.269215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:47:37.272224 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m23:47:37.273215 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:47:37.274216 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m23:47:37.275214 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:47:37.282226 [debug] [Thread-1 (]: Applying DROP to: "qms"."qms"."queue_summary__dbt_backup"
[0m23:47:37.288213 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:47:37.289214 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
drop view if exists "qms"."qms"."queue_summary__dbt_backup" cascade
[0m23:47:37.290213 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:47:37.293217 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m23:47:37.294214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810E6996D0>]}
[0m23:47:37.295215 [info ] [Thread-1 (]: 2 of 3 OK created sql view model qms.queue_summary ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:47:37.297217 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m23:47:37.298218 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.my_second_dbt_model
[0m23:47:37.299225 [info ] [Thread-1 (]: 3 of 3 START sql view model qms.my_second_dbt_model ............................ [RUN]
[0m23:47:37.308215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Analytics_ETL_Model.queue_summary, now model.Analytics_ETL_Model.my_second_dbt_model)
[0m23:47:37.309216 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.my_second_dbt_model
[0m23:47:37.313215 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.my_second_dbt_model"
[0m23:47:37.314229 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.my_second_dbt_model
[0m23:47:37.327216 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.my_second_dbt_model"
[0m23:47:37.328217 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_second_dbt_model"
[0m23:47:37.329216 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_second_dbt_model: BEGIN
[0m23:47:37.330218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:37.384216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m23:47:37.385216 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_second_dbt_model"
[0m23:47:37.386217 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.my_second_dbt_model"} */

  create view "qms"."qms"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "qms"."qms"."my_first_dbt_model"
where id = 1
  );
[0m23:47:37.390222 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:47:37.395213 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_second_dbt_model"
[0m23:47:37.396215 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.my_second_dbt_model"} */
alter table "qms"."qms"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:47:37.397217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:47:37.400217 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_second_dbt_model: COMMIT
[0m23:47:37.401216 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_second_dbt_model"
[0m23:47:37.401216 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_second_dbt_model: COMMIT
[0m23:47:37.403214 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:47:37.406216 [debug] [Thread-1 (]: Applying DROP to: "qms"."qms"."my_second_dbt_model__dbt_backup"
[0m23:47:37.408215 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.my_second_dbt_model"
[0m23:47:37.409217 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.my_second_dbt_model"} */
drop view if exists "qms"."qms"."my_second_dbt_model__dbt_backup" cascade
[0m23:47:37.410218 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:47:37.413216 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.my_second_dbt_model: Close
[0m23:47:37.414215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a99c4c-9a37-4203-89b1-f109b9420d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810E67AF00>]}
[0m23:47:37.415216 [info ] [Thread-1 (]: 3 of 3 OK created sql view model qms.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m23:47:37.417215 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.my_second_dbt_model
[0m23:47:37.419215 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:37.419215 [debug] [MainThread]: On master: BEGIN
[0m23:47:37.420215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:37.478216 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m23:47:37.478216 [debug] [MainThread]: On master: COMMIT
[0m23:47:37.479217 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:37.480216 [debug] [MainThread]: On master: COMMIT
[0m23:47:37.481217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:47:37.482216 [debug] [MainThread]: On master: Close
[0m23:47:37.482216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:37.483217 [debug] [MainThread]: Connection 'create_qms_qms' was properly closed.
[0m23:47:37.484218 [debug] [MainThread]: Connection 'list_qms_qms' was properly closed.
[0m23:47:37.485215 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.my_second_dbt_model' was properly closed.
[0m23:47:37.486218 [info ] [MainThread]: 
[0m23:47:37.488217 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m23:47:37.490216 [debug] [MainThread]: Command end result
[0m23:47:37.529215 [info ] [MainThread]: 
[0m23:47:37.530216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:47:37.531217 [info ] [MainThread]: 
[0m23:47:37.532216 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:47:37.537217 [debug] [MainThread]: Command `dbt run` succeeded at 23:47:37.536216 after 3.96 seconds
[0m23:47:37.538215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810CF4FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810D0B9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810E580470>]}
[0m23:47:37.538215 [debug] [MainThread]: Flushing usage events
[0m23:47:38.119875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:30.505144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED434C7BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED434C78C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED434C6810>]}


============================== 23:57:30.511144 | f8586a28-5ee1-4944-bde2-c26ff14b23f9 ==============================
[0m23:57:30.511144 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m23:57:30.513146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:57:31.262144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8586a28-5ee1-4944-bde2-c26ff14b23f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED439515B0>]}
[0m23:57:31.402143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8586a28-5ee1-4944-bde2-c26ff14b23f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED427B1400>]}
[0m23:57:31.405150 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:57:31.440146 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m23:57:31.651144 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:57:31.652143 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:57:31.653145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8586a28-5ee1-4944-bde2-c26ff14b23f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4384A600>]}
[0m23:57:34.160840 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Analytics_ETL_Model.example
[0m23:57:34.168839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8586a28-5ee1-4944-bde2-c26ff14b23f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED44DE3B90>]}
[0m23:57:34.318838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8586a28-5ee1-4944-bde2-c26ff14b23f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED44EC9CA0>]}
[0m23:57:34.319837 [info ] [MainThread]: Found 1 model, 428 macros
[0m23:57:34.320838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8586a28-5ee1-4944-bde2-c26ff14b23f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED44EBA360>]}
[0m23:57:34.322837 [info ] [MainThread]: 
[0m23:57:34.323837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:57:34.324837 [info ] [MainThread]: 
[0m23:57:34.325837 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:34.327837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m23:57:34.509836 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m23:57:34.511838 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m23:57:34.512837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:34.571838 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m23:57:34.573838 [debug] [ThreadPool]: On list_qms: Close
[0m23:57:34.575839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m23:57:34.588837 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m23:57:34.589837 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m23:57:34.590839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:34.640840 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m23:57:34.641838 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m23:57:34.641838 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:57:34.648837 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m23:57:34.650837 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m23:57:34.651837 [debug] [ThreadPool]: On list_qms_public: Close
[0m23:57:34.658838 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:34.659838 [debug] [MainThread]: On master: BEGIN
[0m23:57:34.660838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:34.724839 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m23:57:34.725841 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:34.725841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:57:34.733837 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:57:34.735838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8586a28-5ee1-4944-bde2-c26ff14b23f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED44D4AFF0>]}
[0m23:57:34.736838 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:34.737838 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:34.738839 [debug] [MainThread]: On master: BEGIN
[0m23:57:34.739839 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:57:34.739839 [debug] [MainThread]: On master: COMMIT
[0m23:57:34.740839 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:34.741837 [debug] [MainThread]: On master: COMMIT
[0m23:57:34.741837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:34.742839 [debug] [MainThread]: On master: Close
[0m23:57:34.760840 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m23:57:34.761840 [info ] [Thread-1 (]: 1 of 1 START sql view model public.queue_summary ............................... [RUN]
[0m23:57:34.762839 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m23:57:34.763841 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m23:57:34.774838 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m23:57:34.775837 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m23:57:34.852781 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m23:57:34.853781 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:57:34.854783 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m23:57:34.857781 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:57:34.928063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m23:57:34.929062 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:57:34.929062 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

  create view "qms"."public"."queue_summary__dbt_tmp"
    
    
  as (
    WITH daily_reservations AS (
    SELECT
        queue_id,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id
  );
[0m23:57:34.934062 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:57:34.943626 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:57:34.944691 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."public"."queue_summary__dbt_tmp" rename to "queue_summary"
[0m23:57:34.945205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:57:34.966801 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m23:57:34.967316 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:57:34.968605 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m23:57:34.970120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:57:34.979119 [debug] [Thread-1 (]: Applying DROP to: "qms"."public"."queue_summary__dbt_backup"
[0m23:57:34.987121 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:57:34.988127 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
drop view if exists "qms"."public"."queue_summary__dbt_backup" cascade
[0m23:57:34.989120 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:57:34.992118 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m23:57:34.994120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8586a28-5ee1-4944-bde2-c26ff14b23f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED40D13590>]}
[0m23:57:34.996121 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.queue_summary .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m23:57:34.997121 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m23:57:34.999071 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:35.000114 [debug] [MainThread]: On master: BEGIN
[0m23:57:35.000114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:57:35.056104 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m23:57:35.056104 [debug] [MainThread]: On master: COMMIT
[0m23:57:35.057104 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:35.058104 [debug] [MainThread]: On master: COMMIT
[0m23:57:35.059105 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:35.060102 [debug] [MainThread]: On master: Close
[0m23:57:35.061104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:35.061104 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m23:57:35.062108 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m23:57:35.063104 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m23:57:35.064105 [info ] [MainThread]: 
[0m23:57:35.065106 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m23:57:35.067103 [debug] [MainThread]: Command end result
[0m23:57:35.170102 [info ] [MainThread]: 
[0m23:57:35.172105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:57:35.173106 [info ] [MainThread]: 
[0m23:57:35.174104 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:57:35.178103 [debug] [MainThread]: Command `dbt run` succeeded at 23:57:35.178103 after 4.98 seconds
[0m23:57:35.180103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED44E885F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED436201D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED42E38260>]}
[0m23:57:35.181102 [debug] [MainThread]: Flushing usage events
[0m23:57:35.737102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:58:28.191062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7667560F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F769B19D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F769277CE0>]}


============================== 23:58:28.197063 | c94d0ab1-4081-418f-bbb6-762be2dbf128 ==============================
[0m23:58:28.197063 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m23:58:28.199063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:58:28.514061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c94d0ab1-4081-418f-bbb6-762be2dbf128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F769E441A0>]}
[0m23:58:28.611062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c94d0ab1-4081-418f-bbb6-762be2dbf128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7699F0AA0>]}
[0m23:58:28.613063 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:58:28.626062 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m23:58:28.726062 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:58:28.728064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c94d0ab1-4081-418f-bbb6-762be2dbf128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7697743E0>]}
[0m23:58:30.281387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c94d0ab1-4081-418f-bbb6-762be2dbf128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76B311FD0>]}
[0m23:58:30.406387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c94d0ab1-4081-418f-bbb6-762be2dbf128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76B39C500>]}
[0m23:58:30.407386 [info ] [MainThread]: Found 1 model, 428 macros
[0m23:58:30.408387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94d0ab1-4081-418f-bbb6-762be2dbf128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76B421D60>]}
[0m23:58:30.411398 [info ] [MainThread]: 
[0m23:58:30.412388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:30.412388 [info ] [MainThread]: 
[0m23:58:30.413387 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:30.415386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m23:58:30.606386 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m23:58:30.607387 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m23:58:30.608386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:30.664388 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.057 seconds
[0m23:58:30.667389 [debug] [ThreadPool]: On list_qms: Close
[0m23:58:30.670389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m23:58:30.680388 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m23:58:30.680388 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m23:58:30.681387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:30.836390 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m23:58:30.837390 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m23:58:30.838387 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:58:30.844387 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m23:58:30.847386 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m23:58:30.848387 [debug] [ThreadPool]: On list_qms_public: Close
[0m23:58:30.855387 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:30.856387 [debug] [MainThread]: On master: BEGIN
[0m23:58:30.857386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:30.910388 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m23:58:30.911389 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:30.912386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:58:30.922387 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m23:58:30.924386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94d0ab1-4081-418f-bbb6-762be2dbf128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76A1449B0>]}
[0m23:58:30.925386 [debug] [MainThread]: On master: ROLLBACK
[0m23:58:30.926387 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:30.927387 [debug] [MainThread]: On master: BEGIN
[0m23:58:30.928398 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:58:30.929388 [debug] [MainThread]: On master: COMMIT
[0m23:58:30.929388 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:30.930391 [debug] [MainThread]: On master: COMMIT
[0m23:58:30.931387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:58:30.932387 [debug] [MainThread]: On master: Close
[0m23:58:30.937396 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m23:58:30.938387 [info ] [Thread-1 (]: 1 of 1 START sql table model public.queue_summary .............................. [RUN]
[0m23:58:30.939388 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m23:58:30.940387 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m23:58:30.950388 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m23:58:30.951390 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m23:58:31.023388 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m23:58:31.025387 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:58:31.026386 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m23:58:31.026386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:58:31.198902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.172 seconds
[0m23:58:31.199972 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:58:31.200498 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

  
    

  create  table "qms"."public"."queue_summary__dbt_tmp"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id
  );
  
[0m23:58:31.211315 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.010 seconds
[0m23:58:31.221189 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:58:31.222194 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."public"."queue_summary" rename to "queue_summary__dbt_backup"
[0m23:58:31.223191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:58:31.228423 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:58:31.228423 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."public"."queue_summary__dbt_tmp" rename to "queue_summary"
[0m23:58:31.230425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:58:31.260423 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m23:58:31.261423 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:58:31.261423 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m23:58:31.263437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:58:31.272424 [debug] [Thread-1 (]: Applying DROP to: "qms"."public"."queue_summary__dbt_backup"
[0m23:58:31.280422 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m23:58:31.281424 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
drop view if exists "qms"."public"."queue_summary__dbt_backup" cascade
[0m23:58:31.283423 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:58:31.287429 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m23:58:31.289424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d0ab1-4081-418f-bbb6-762be2dbf128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7671D7230>]}
[0m23:58:31.291425 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.queue_summary ......................... [[32mSELECT 2[0m in 0.35s]
[0m23:58:31.292425 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m23:58:31.294423 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:31.295424 [debug] [MainThread]: On master: BEGIN
[0m23:58:31.295424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:31.351423 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m23:58:31.352423 [debug] [MainThread]: On master: COMMIT
[0m23:58:31.352423 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:31.353423 [debug] [MainThread]: On master: COMMIT
[0m23:58:31.354425 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:58:31.355425 [debug] [MainThread]: On master: Close
[0m23:58:31.356424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:31.357425 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m23:58:31.358425 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m23:58:31.359425 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m23:58:31.360427 [info ] [MainThread]: 
[0m23:58:31.360427 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m23:58:31.362422 [debug] [MainThread]: Command end result
[0m23:58:31.473425 [info ] [MainThread]: 
[0m23:58:31.474423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:58:31.475424 [info ] [MainThread]: 
[0m23:58:31.476423 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:58:31.478423 [debug] [MainThread]: Command `dbt run` succeeded at 23:58:31.478423 after 3.52 seconds
[0m23:58:31.479422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7696950A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76B3DC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76B3A2A50>]}
[0m23:58:31.480424 [debug] [MainThread]: Flushing usage events
[0m23:58:32.175424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:18.728844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC37807AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC34F232F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC37806A20>]}


============================== 00:06:18.733799 | 42b0a9cd-128a-4c00-b2e5-f54382dc770f ==============================
[0m00:06:18.733799 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:06:18.734973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:06:19.058983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42b0a9cd-128a-4c00-b2e5-f54382dc770f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC37E23A10>]}
[0m00:06:19.166984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42b0a9cd-128a-4c00-b2e5-f54382dc770f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC373DCF80>]}
[0m00:06:19.170003 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:06:19.188747 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:06:19.434233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:06:19.435243 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:06:19.474234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42b0a9cd-128a-4c00-b2e5-f54382dc770f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC3906FB60>]}
[0m00:06:19.596234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42b0a9cd-128a-4c00-b2e5-f54382dc770f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC3904C260>]}
[0m00:06:19.597235 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:06:19.598235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42b0a9cd-128a-4c00-b2e5-f54382dc770f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC39081160>]}
[0m00:06:19.601234 [info ] [MainThread]: 
[0m00:06:19.602235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:19.604236 [info ] [MainThread]: 
[0m00:06:19.606237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:06:19.608236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:06:19.816235 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:06:19.817235 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:06:19.818235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:19.882234 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m00:06:19.884235 [debug] [ThreadPool]: On list_qms: Close
[0m00:06:19.888239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:06:19.896234 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:06:19.897234 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:06:19.898234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:19.958235 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m00:06:19.959236 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:06:19.960235 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:06:19.966235 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:06:19.968234 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:06:19.969236 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:06:19.980234 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:19.981235 [debug] [MainThread]: On master: BEGIN
[0m00:06:19.982241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:20.036234 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m00:06:20.037240 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:20.038236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:06:20.047236 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m00:06:20.049237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42b0a9cd-128a-4c00-b2e5-f54382dc770f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC394B7CE0>]}
[0m00:06:20.049768 [debug] [MainThread]: On master: ROLLBACK
[0m00:06:20.050755 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:20.051764 [debug] [MainThread]: On master: BEGIN
[0m00:06:20.053760 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:06:20.053760 [debug] [MainThread]: On master: COMMIT
[0m00:06:20.054760 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:20.055761 [debug] [MainThread]: On master: COMMIT
[0m00:06:20.056762 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:06:20.057760 [debug] [MainThread]: On master: Close
[0m00:06:20.062755 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:06:20.063759 [info ] [Thread-1 (]: 1 of 1 START sql table model public.queue_summary .............................. [RUN]
[0m00:06:20.064758 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:06:20.065758 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:06:20.075757 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:06:20.077770 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:06:20.151755 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:06:20.155756 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:20.156754 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:06:20.157763 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:06:20.311680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.153 seconds
[0m00:06:20.312718 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:20.313728 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

  
    

  create  table "qms"."public"."queue_summary__dbt_tmp"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id
  );
  
[0m00:06:20.325989 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m00:06:20.334993 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:20.336985 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."public"."queue_summary" rename to "queue_summary__dbt_backup"
[0m00:06:20.337983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:06:20.343011 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:20.344011 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."public"."queue_summary__dbt_tmp" rename to "queue_summary"
[0m00:06:20.345047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:06:20.375993 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:06:20.377984 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:20.377984 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:06:20.379983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:06:20.389983 [debug] [Thread-1 (]: Applying DROP to: "qms"."public"."queue_summary__dbt_backup"
[0m00:06:20.398029 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:20.398982 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
drop table if exists "qms"."public"."queue_summary__dbt_backup" cascade
[0m00:06:20.402984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:06:20.407030 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:06:20.408984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42b0a9cd-128a-4c00-b2e5-f54382dc770f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC37F7BB30>]}
[0m00:06:20.411002 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.queue_summary ......................... [[32mSELECT 2[0m in 0.34s]
[0m00:06:20.412982 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:06:20.415003 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:20.415003 [debug] [MainThread]: On master: BEGIN
[0m00:06:20.416030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:06:20.579448 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m00:06:20.580416 [debug] [MainThread]: On master: COMMIT
[0m00:06:20.580416 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:20.581417 [debug] [MainThread]: On master: COMMIT
[0m00:06:20.582412 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:06:20.583449 [debug] [MainThread]: On master: Close
[0m00:06:20.584451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:20.584451 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:06:20.585402 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:06:20.586404 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:06:20.587406 [info ] [MainThread]: 
[0m00:06:20.588414 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m00:06:20.590411 [debug] [MainThread]: Command end result
[0m00:06:20.633455 [info ] [MainThread]: 
[0m00:06:20.635401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:06:20.639404 [info ] [MainThread]: 
[0m00:06:20.642470 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:06:20.646430 [debug] [MainThread]: Command `dbt run` succeeded at 00:06:20.646430 after 2.16 seconds
[0m00:06:20.647446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC3732EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC393E7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC372E5B80>]}
[0m00:06:20.648411 [debug] [MainThread]: Flushing usage events
[0m00:06:21.368638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:56.757616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E90C4B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EC3D7BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EC3D6690>]}


============================== 00:06:56.762615 | aff1bd0f-4c3e-4261-923c-2365283ddb98 ==============================
[0m00:06:56.762615 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:06:56.763634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:06:57.096616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aff1bd0f-4c3e-4261-923c-2365283ddb98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EC7595B0>]}
[0m00:06:57.197511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aff1bd0f-4c3e-4261-923c-2365283ddb98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EC8C0DD0>]}
[0m00:06:57.199511 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:06:57.220577 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:06:57.451861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:06:57.452861 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\queue_summary.sql
[0m00:06:57.799897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aff1bd0f-4c3e-4261-923c-2365283ddb98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EC9EDC70>]}
[0m00:06:57.914894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aff1bd0f-4c3e-4261-923c-2365283ddb98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EDE68470>]}
[0m00:06:57.915894 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:06:57.916894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff1bd0f-4c3e-4261-923c-2365283ddb98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EDD53800>]}
[0m00:06:57.919894 [info ] [MainThread]: 
[0m00:06:57.920893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:57.921893 [info ] [MainThread]: 
[0m00:06:57.922895 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:06:57.924893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:06:58.084895 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:06:58.085892 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:06:58.087892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:58.146893 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.059 seconds
[0m00:06:58.149892 [debug] [ThreadPool]: On list_qms: Close
[0m00:06:58.153893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:06:58.162894 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:06:58.163894 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:06:58.164890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:58.218893 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m00:06:58.219895 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:06:58.219895 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:06:58.248893 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m00:06:58.251897 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:06:58.252895 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:06:58.260895 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:58.262912 [debug] [MainThread]: On master: BEGIN
[0m00:06:58.263895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:58.359892 [debug] [MainThread]: SQL status: BEGIN in 0.096 seconds
[0m00:06:58.359892 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:58.360898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:06:58.369897 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:06:58.371894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff1bd0f-4c3e-4261-923c-2365283ddb98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EE2006E0>]}
[0m00:06:58.372897 [debug] [MainThread]: On master: ROLLBACK
[0m00:06:58.373896 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:58.374897 [debug] [MainThread]: On master: BEGIN
[0m00:06:58.375894 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:06:58.376894 [debug] [MainThread]: On master: COMMIT
[0m00:06:58.376894 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:58.377897 [debug] [MainThread]: On master: COMMIT
[0m00:06:58.378893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:06:58.379895 [debug] [MainThread]: On master: Close
[0m00:06:58.394895 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:06:58.395895 [info ] [Thread-1 (]: 1 of 1 START sql table model public.queue_summary .............................. [RUN]
[0m00:06:58.398894 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:06:58.399894 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:06:58.408894 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:06:58.410894 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:06:58.510897 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:06:58.512898 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:58.513894 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:06:58.515896 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:06:58.578893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m00:06:58.579893 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:58.580893 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

  
    

  create  table "qms"."public"."queue_summary__dbt_tmp"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-28') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
[0m00:06:58.589893 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m00:06:58.601893 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:58.602900 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."public"."queue_summary" rename to "queue_summary__dbt_backup"
[0m00:06:58.603893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:06:58.607892 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:58.608893 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."public"."queue_summary__dbt_tmp" rename to "queue_summary"
[0m00:06:58.609893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:06:58.641892 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:06:58.642892 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:58.642892 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:06:58.644894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:06:58.654894 [debug] [Thread-1 (]: Applying DROP to: "qms"."public"."queue_summary__dbt_backup"
[0m00:06:58.663898 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:06:58.664896 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
drop table if exists "qms"."public"."queue_summary__dbt_backup" cascade
[0m00:06:58.669895 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m00:06:58.672899 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:06:58.675897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aff1bd0f-4c3e-4261-923c-2365283ddb98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E9C27500>]}
[0m00:06:58.676903 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.queue_summary ......................... [[32mSELECT 2[0m in 0.28s]
[0m00:06:58.682914 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:06:58.694892 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:58.701898 [debug] [MainThread]: On master: BEGIN
[0m00:06:58.706892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:06:58.784893 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m00:06:58.785897 [debug] [MainThread]: On master: COMMIT
[0m00:06:58.785897 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:58.786897 [debug] [MainThread]: On master: COMMIT
[0m00:06:58.787895 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:06:58.788900 [debug] [MainThread]: On master: Close
[0m00:06:58.789894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:58.790893 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:06:58.790893 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:06:58.791892 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:06:58.792892 [info ] [MainThread]: 
[0m00:06:58.793894 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m00:06:58.795896 [debug] [MainThread]: Command end result
[0m00:06:58.835894 [info ] [MainThread]: 
[0m00:06:58.837895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:06:58.838893 [info ] [MainThread]: 
[0m00:06:58.839894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:06:58.842898 [debug] [MainThread]: Command `dbt run` succeeded at 00:06:58.842898 after 2.32 seconds
[0m00:06:58.844896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182ECB940B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EC95A300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EBFB4FE0>]}
[0m00:06:58.845894 [debug] [MainThread]: Flushing usage events
[0m00:06:59.516857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:28.591580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A847C6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A84C07B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A84946780>]}


============================== 00:07:28.597581 | ceae345f-b7b2-4ea0-a9d2-3d1afda58672 ==============================
[0m00:07:28.597581 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:07:28.600585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:07:28.970582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceae345f-b7b2-4ea0-a9d2-3d1afda58672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A84E01820>]}
[0m00:07:29.070584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceae345f-b7b2-4ea0-a9d2-3d1afda58672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A845A5970>]}
[0m00:07:29.073581 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:07:29.086581 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:07:29.325579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:29.326581 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\queue_summary.sql
[0m00:07:29.684689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceae345f-b7b2-4ea0-a9d2-3d1afda58672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A8632D1C0>]}
[0m00:07:29.827670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceae345f-b7b2-4ea0-a9d2-3d1afda58672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A863585C0>]}
[0m00:07:29.829671 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:07:29.830671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceae345f-b7b2-4ea0-a9d2-3d1afda58672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A82B32180>]}
[0m00:07:29.834680 [info ] [MainThread]: 
[0m00:07:29.835671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:29.837686 [info ] [MainThread]: 
[0m00:07:29.839677 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:07:29.841671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:07:30.024671 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:07:30.025673 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:07:30.026672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:30.098680 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.072 seconds
[0m00:07:30.101690 [debug] [ThreadPool]: On list_qms: Close
[0m00:07:30.105672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:07:30.112669 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:07:30.114675 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:07:30.115674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:30.166676 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m00:07:30.167675 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:07:30.168674 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:07:30.175670 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:07:30.177669 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:07:30.177669 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:07:30.186671 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:30.187671 [debug] [MainThread]: On master: BEGIN
[0m00:07:30.187671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:30.240678 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m00:07:30.241671 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:30.242671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:07:30.251671 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:07:30.253669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceae345f-b7b2-4ea0-a9d2-3d1afda58672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A86359520>]}
[0m00:07:30.253669 [debug] [MainThread]: On master: ROLLBACK
[0m00:07:30.254674 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:30.255671 [debug] [MainThread]: On master: BEGIN
[0m00:07:30.256671 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:07:30.257672 [debug] [MainThread]: On master: COMMIT
[0m00:07:30.257672 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:30.258673 [debug] [MainThread]: On master: COMMIT
[0m00:07:30.259671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:30.260681 [debug] [MainThread]: On master: Close
[0m00:07:30.266672 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:07:30.267673 [info ] [Thread-1 (]: 1 of 1 START sql table model public.queue_summary .............................. [RUN]
[0m00:07:30.269673 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:07:30.269673 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:07:30.288685 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:07:30.290682 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:07:30.377832 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:07:30.383832 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:07:30.384833 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:07:30.386233 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:07:30.440066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m00:07:30.441128 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:07:30.441656 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

  
    

  create  table "qms"."public"."queue_summary__dbt_tmp"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-29') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-29'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
[0m00:07:30.451872 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m00:07:30.462106 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:07:30.463155 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."public"."queue_summary" rename to "queue_summary__dbt_backup"
[0m00:07:30.464687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:07:30.468722 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:07:30.469722 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
alter table "qms"."public"."queue_summary__dbt_tmp" rename to "queue_summary"
[0m00:07:30.471728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:07:30.505858 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:07:30.506381 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:07:30.508198 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:07:30.509901 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:07:30.520380 [debug] [Thread-1 (]: Applying DROP to: "qms"."public"."queue_summary__dbt_backup"
[0m00:07:30.528380 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:07:30.529389 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */
drop table if exists "qms"."public"."queue_summary__dbt_backup" cascade
[0m00:07:30.533607 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:07:30.537194 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:07:30.539706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceae345f-b7b2-4ea0-a9d2-3d1afda58672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A8625B2C0>]}
[0m00:07:30.540717 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.queue_summary ......................... [[32mSELECT 0[0m in 0.27s]
[0m00:07:30.544705 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:07:30.547706 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:30.548705 [debug] [MainThread]: On master: BEGIN
[0m00:07:30.549705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:07:30.620415 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m00:07:30.621416 [debug] [MainThread]: On master: COMMIT
[0m00:07:30.622419 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:30.622419 [debug] [MainThread]: On master: COMMIT
[0m00:07:30.623415 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:30.624415 [debug] [MainThread]: On master: Close
[0m00:07:30.624415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:30.625415 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:07:30.626415 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:07:30.626415 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:07:30.627419 [info ] [MainThread]: 
[0m00:07:30.628416 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m00:07:30.630418 [debug] [MainThread]: Command end result
[0m00:07:30.675416 [info ] [MainThread]: 
[0m00:07:30.677417 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:30.678433 [info ] [MainThread]: 
[0m00:07:30.679416 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:07:30.685415 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:30.685415 after 2.36 seconds
[0m00:07:30.686417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A84347B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A862870B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A84CC54F0>]}
[0m00:07:30.687415 [debug] [MainThread]: Flushing usage events
[0m00:07:31.227969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:10:17.752440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C228CB2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C228560B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C228A56870>]}


============================== 00:10:17.757409 | a4942f2f-03de-4449-bdbd-cb178405d414 ==============================
[0m00:10:17.757409 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:10:17.759410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:10:18.036427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4942f2f-03de-4449-bdbd-cb178405d414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2290A9BE0>]}
[0m00:10:18.118445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4942f2f-03de-4449-bdbd-cb178405d414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C228F3C6B0>]}
[0m00:10:18.120447 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:18.136409 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:10:18.216447 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:10:18.218411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a4942f2f-03de-4449-bdbd-cb178405d414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C228D73320>]}
[0m00:10:19.502803 [error] [MainThread]: Encountered an error:
Compilation Error in model queue_summary (models\queue_summary.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m00:10:19.505842 [debug] [MainThread]: Command `dbt run` failed at 00:10:19.505842 after 1.97 seconds
[0m00:10:19.506834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C228A15FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2290EF470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2291FE150>]}
[0m00:10:19.507822 [debug] [MainThread]: Flushing usage events
[0m00:10:20.097126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:10:40.331716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A07442030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A04909970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A072866F0>]}


============================== 00:10:40.337718 | ab6d5dcc-1603-403e-b0f8-e1cdaab9425f ==============================
[0m00:10:40.337718 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:10:40.339717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:10:40.642355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab6d5dcc-1603-403e-b0f8-e1cdaab9425f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A04B04380>]}
[0m00:10:40.722392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab6d5dcc-1603-403e-b0f8-e1cdaab9425f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A04A2EF30>]}
[0m00:10:40.723407 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:40.739354 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:10:40.822357 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:10:40.823306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab6d5dcc-1603-403e-b0f8-e1cdaab9425f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A074E0CB0>]}
[0m00:10:42.392761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab6d5dcc-1603-403e-b0f8-e1cdaab9425f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A08C4C1A0>]}
[0m00:10:42.517765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab6d5dcc-1603-403e-b0f8-e1cdaab9425f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A08CE5DC0>]}
[0m00:10:42.519764 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:10:42.523763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab6d5dcc-1603-403e-b0f8-e1cdaab9425f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A08C53470>]}
[0m00:10:42.526764 [info ] [MainThread]: 
[0m00:10:42.528765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:10:42.529763 [info ] [MainThread]: 
[0m00:10:42.530762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:42.532763 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:10:42.760861 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:10:42.761858 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:10:42.762858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:42.896561 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.134 seconds
[0m00:10:42.899557 [debug] [ThreadPool]: On list_qms: Close
[0m00:10:42.940247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:10:42.948761 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:10:42.949762 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:10:42.950761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:43.044754 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m00:10:43.045756 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:10:43.046755 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:10:43.052756 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:10:43.054760 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:10:43.055759 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:10:43.062758 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:43.063759 [debug] [MainThread]: On master: BEGIN
[0m00:10:43.063759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:43.145845 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m00:10:43.146846 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:43.147847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:43.156845 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m00:10:43.159051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab6d5dcc-1603-403e-b0f8-e1cdaab9425f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A08C45820>]}
[0m00:10:43.160102 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:43.161089 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:43.162091 [debug] [MainThread]: On master: BEGIN
[0m00:10:43.163090 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:43.163090 [debug] [MainThread]: On master: COMMIT
[0m00:10:43.164091 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:43.165090 [debug] [MainThread]: On master: COMMIT
[0m00:10:43.165090 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:43.166089 [debug] [MainThread]: On master: Close
[0m00:10:43.221092 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:10:43.222091 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:10:43.224090 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:10:43.225090 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:10:43.281089 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:10:43.283089 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:10:43.403811 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:10:43.405810 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp001043359136"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-28') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:10:43.407810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:10:43.501813 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.094 seconds
[0m00:10:43.520815 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:10:43.521811 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:10:43.522813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:10:43.523816 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:10:43.524811 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp001043359136'
        
      order by ordinal_position

  
[0m00:10:43.538812 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.013 seconds
[0m00:10:43.545811 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:10:43.546811 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:10:43.551809 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:10:43.562812 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:10:43.563812 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:10:43.568812 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:10:43.586811 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:10:43.588811 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:10:43.589812 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp001043359136"
    )


  
[0m00:10:43.590811 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.001 seconds
[0m00:10:43.611810 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:10:43.612828 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:10:43.613811 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:10:43.614810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:10:43.617811 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:10:43.619814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab6d5dcc-1603-403e-b0f8-e1cdaab9425f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A04AD7440>]}
[0m00:10:43.621813 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 2[0m in 0.39s]
[0m00:10:43.630812 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:10:43.632810 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:43.633810 [debug] [MainThread]: On master: BEGIN
[0m00:10:43.633810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:43.693811 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m00:10:43.693811 [debug] [MainThread]: On master: COMMIT
[0m00:10:43.694811 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:43.695812 [debug] [MainThread]: On master: COMMIT
[0m00:10:43.695812 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:43.696811 [debug] [MainThread]: On master: Close
[0m00:10:43.697811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:43.698812 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:10:43.699811 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:10:43.699811 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:10:43.700812 [info ] [MainThread]: 
[0m00:10:43.701813 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m00:10:43.703812 [debug] [MainThread]: Command end result
[0m00:10:43.802810 [info ] [MainThread]: 
[0m00:10:43.804813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:43.805813 [info ] [MainThread]: 
[0m00:10:43.806818 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:10:43.809810 [debug] [MainThread]: Command `dbt run` succeeded at 00:10:43.808820 after 3.78 seconds
[0m00:10:43.810810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A04AD7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A074A9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A070E7B60>]}
[0m00:10:43.810810 [debug] [MainThread]: Flushing usage events
[0m00:10:44.361963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:10:59.535390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A672B3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A6A356F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A6A354710>]}


============================== 00:10:59.541391 | dab617f1-ebf2-4306-aecf-5e0864bc23c8 ==============================
[0m00:10:59.541391 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:10:59.543392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:10:59.837137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dab617f1-ebf2-4306-aecf-5e0864bc23c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A69CACEF0>]}
[0m00:10:59.916916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dab617f1-ebf2-4306-aecf-5e0864bc23c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A696CE600>]}
[0m00:10:59.918910 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:59.929862 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:11:00.124899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:00.125900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:00.159901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dab617f1-ebf2-4306-aecf-5e0864bc23c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A6A1CAA20>]}
[0m00:11:00.270873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dab617f1-ebf2-4306-aecf-5e0864bc23c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A6BB801A0>]}
[0m00:11:00.271873 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:11:00.273863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab617f1-ebf2-4306-aecf-5e0864bc23c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A6BB8AD80>]}
[0m00:11:00.275905 [info ] [MainThread]: 
[0m00:11:00.277864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:00.278863 [info ] [MainThread]: 
[0m00:11:00.280864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:11:00.282864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:11:00.443862 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:11:00.444876 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:11:00.445862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:00.607851 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.162 seconds
[0m00:11:00.609888 [debug] [ThreadPool]: On list_qms: Close
[0m00:11:00.611852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:11:00.620900 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:11:00.620900 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:11:00.621896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:00.671391 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m00:11:00.672443 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:11:00.673446 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:11:00.678402 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:11:00.680412 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:11:00.681439 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:11:00.690449 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:00.690449 [debug] [MainThread]: On master: BEGIN
[0m00:11:00.691446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:11:00.739935 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m00:11:00.740948 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:00.741937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:11:00.749311 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:11:00.751323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab617f1-ebf2-4306-aecf-5e0864bc23c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A6BFE68D0>]}
[0m00:11:00.751323 [debug] [MainThread]: On master: ROLLBACK
[0m00:11:00.752323 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:00.753323 [debug] [MainThread]: On master: BEGIN
[0m00:11:00.754364 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:11:00.754364 [debug] [MainThread]: On master: COMMIT
[0m00:11:00.755366 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:00.756346 [debug] [MainThread]: On master: COMMIT
[0m00:11:00.757391 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:11:00.758368 [debug] [MainThread]: On master: Close
[0m00:11:00.762322 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:11:00.763322 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:11:00.765337 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:11:00.766381 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:11:00.775323 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:11:00.778325 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:11:00.861369 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:11:00.863345 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp001100825322"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-28') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:11:00.864323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:11:00.920337 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.057 seconds
[0m00:11:00.940321 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:11:00.941322 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:11:00.943325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:11:00.944324 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:11:00.945331 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp001100825322'
        
      order by ordinal_position

  
[0m00:11:00.958323 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.012 seconds
[0m00:11:00.967324 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:11:00.968323 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:11:00.973326 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:11:00.985320 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:11:00.986323 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:11:00.991323 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:11:01.006323 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:11:01.008330 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:11:01.009330 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp001100825322"
    )


  
[0m00:11:01.010323 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.001 seconds
[0m00:11:01.029322 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:11:01.030322 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:11:01.030322 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:11:01.032322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:11:01.034322 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:11:01.037323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab617f1-ebf2-4306-aecf-5e0864bc23c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A67BEACF0>]}
[0m00:11:01.038324 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 2[0m in 0.27s]
[0m00:11:01.040337 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:11:01.042323 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:01.042323 [debug] [MainThread]: On master: BEGIN
[0m00:11:01.043322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:11:01.100322 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m00:11:01.101322 [debug] [MainThread]: On master: COMMIT
[0m00:11:01.102322 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:01.103321 [debug] [MainThread]: On master: COMMIT
[0m00:11:01.104322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:11:01.104322 [debug] [MainThread]: On master: Close
[0m00:11:01.105323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:01.106324 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:11:01.107323 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:11:01.107323 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:11:01.108324 [info ] [MainThread]: 
[0m00:11:01.110323 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m00:11:01.111322 [debug] [MainThread]: Command end result
[0m00:11:01.151338 [info ] [MainThread]: 
[0m00:11:01.152340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:11:01.154322 [info ] [MainThread]: 
[0m00:11:01.155336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:11:01.158322 [debug] [MainThread]: Command `dbt run` succeeded at 00:11:01.158322 after 1.84 seconds
[0m00:11:01.158322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A67292A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A6AB3D220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A66E45CA0>]}
[0m00:11:01.159322 [debug] [MainThread]: Flushing usage events
[0m00:11:01.665298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:51.266373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A9A86630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A9AF0A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A9A87A10>]}


============================== 00:18:51.271411 | 4b9c518d-7435-4dce-80f9-700e68bc272e ==============================
[0m00:18:51.271411 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:18:51.272376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:18:51.558410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b9c518d-7435-4dce-80f9-700e68bc272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A9EF6720>]}
[0m00:18:51.639424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b9c518d-7435-4dce-80f9-700e68bc272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A96FBFB0>]}
[0m00:18:51.641422 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:18:51.655421 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:18:51.745410 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:18:51.746410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b9c518d-7435-4dce-80f9-700e68bc272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AB2C52B0>]}
[0m00:18:53.492849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b9c518d-7435-4dce-80f9-700e68bc272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AB462F90>]}
[0m00:18:53.623849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b9c518d-7435-4dce-80f9-700e68bc272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AB5EA540>]}
[0m00:18:53.624849 [info ] [MainThread]: Found 1 model, 2 data tests, 428 macros
[0m00:18:53.625849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b9c518d-7435-4dce-80f9-700e68bc272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AB5EFAD0>]}
[0m00:18:53.628847 [info ] [MainThread]: 
[0m00:18:53.629863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:53.630849 [info ] [MainThread]: 
[0m00:18:53.631851 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:18:53.632850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:18:53.829849 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:18:53.830857 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:18:53.830857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:53.889848 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.058 seconds
[0m00:18:53.891848 [debug] [ThreadPool]: On list_qms: Close
[0m00:18:53.893850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:18:53.901849 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:18:53.902850 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:18:53.903849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:53.951852 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m00:18:53.952850 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:18:53.953850 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:18:53.958848 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:18:53.960849 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:18:53.961847 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:18:53.969850 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:53.970849 [debug] [MainThread]: On master: BEGIN
[0m00:18:53.970849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:54.020849 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m00:18:54.021850 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:54.021850 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:18:54.029849 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:18:54.031855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b9c518d-7435-4dce-80f9-700e68bc272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AB5A1580>]}
[0m00:18:54.032850 [debug] [MainThread]: On master: ROLLBACK
[0m00:18:54.033865 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:54.034853 [debug] [MainThread]: On master: BEGIN
[0m00:18:54.036851 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:18:54.036851 [debug] [MainThread]: On master: COMMIT
[0m00:18:54.037850 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:54.038849 [debug] [MainThread]: On master: COMMIT
[0m00:18:54.039850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:18:54.039850 [debug] [MainThread]: On master: Close
[0m00:18:54.044853 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:18:54.045850 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:18:54.047861 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:18:54.048852 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:18:54.057850 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:18:54.059851 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:18:54.141849 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:18:54.142849 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp001854106848"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-28') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:18:54.143849 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:54.204860 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.061 seconds
[0m00:18:54.222852 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:18:54.223849 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:18:54.224850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:18:54.225850 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:18:54.226849 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp001854106848'
        
      order by ordinal_position

  
[0m00:18:54.238850 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m00:18:54.246849 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:18:54.246849 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:18:54.252847 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:18:54.262849 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:18:54.263850 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:18:54.268848 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:18:54.286850 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:18:54.287869 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:18:54.288850 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp001854106848"
    )


  
[0m00:18:54.289849 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.001 seconds
[0m00:18:54.314850 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:18:54.315850 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:18:54.316850 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:18:54.318853 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:18:54.321853 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:18:54.323850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b9c518d-7435-4dce-80f9-700e68bc272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AB291940>]}
[0m00:18:54.324851 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 2[0m in 0.28s]
[0m00:18:54.326852 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:18:54.330852 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:54.331853 [debug] [MainThread]: On master: BEGIN
[0m00:18:54.332853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:54.399850 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m00:18:54.400858 [debug] [MainThread]: On master: COMMIT
[0m00:18:54.401853 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:54.402853 [debug] [MainThread]: On master: COMMIT
[0m00:18:54.403853 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:18:54.403853 [debug] [MainThread]: On master: Close
[0m00:18:54.404851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:54.405854 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:18:54.406856 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:18:54.407853 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:18:54.407853 [info ] [MainThread]: 
[0m00:18:54.410106 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m00:18:54.411853 [debug] [MainThread]: Command end result
[0m00:18:54.467850 [info ] [MainThread]: 
[0m00:18:54.468851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:18:54.469851 [info ] [MainThread]: 
[0m00:18:54.470851 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:18:54.472851 [debug] [MainThread]: Command `dbt run` succeeded at 00:18:54.472851 after 3.50 seconds
[0m00:18:54.473851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AB61D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198AB61E0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A939E5A0>]}
[0m00:18:54.474866 [debug] [MainThread]: Flushing usage events
[0m00:18:55.021445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:40.347000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ABED23770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC2189310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC2189B50>]}


============================== 00:29:40.353043 | 2b5272ce-2e9d-4b93-8403-fc4f0fe2e75d ==============================
[0m00:29:40.353043 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:29:40.355003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:29:40.668999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b5272ce-2e9d-4b93-8403-fc4f0fe2e75d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ABF6841D0>]}
[0m00:29:40.758016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b5272ce-2e9d-4b93-8403-fc4f0fe2e75d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC1777E30>]}
[0m00:29:40.761025 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:29:40.776001 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:29:41.007001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:29:41.007001 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\config.yml
[0m00:29:41.468049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b5272ce-2e9d-4b93-8403-fc4f0fe2e75d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC37F84A0>]}
[0m00:29:41.577003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b5272ce-2e9d-4b93-8403-fc4f0fe2e75d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC38E4440>]}
[0m00:29:41.579003 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:29:41.580003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b5272ce-2e9d-4b93-8403-fc4f0fe2e75d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC385FBC0>]}
[0m00:29:41.583002 [info ] [MainThread]: 
[0m00:29:41.584000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:29:41.585002 [info ] [MainThread]: 
[0m00:29:41.587004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:29:41.593022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:29:41.754004 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:29:41.755004 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:29:41.756004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:41.846000 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.090 seconds
[0m00:29:41.847999 [debug] [ThreadPool]: On list_qms: Close
[0m00:29:41.850001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:29:41.857999 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:29:41.859000 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:29:41.860001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:41.914014 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m00:29:41.915002 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:29:41.915002 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:29:41.922002 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m00:29:41.925002 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:29:41.926004 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:29:41.933004 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:41.934002 [debug] [MainThread]: On master: BEGIN
[0m00:29:41.935003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:41.994003 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m00:29:41.995004 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:41.996004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:29:42.003004 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:29:42.005001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b5272ce-2e9d-4b93-8403-fc4f0fe2e75d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC383DCD0>]}
[0m00:29:42.006000 [debug] [MainThread]: On master: ROLLBACK
[0m00:29:42.007002 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:42.008002 [debug] [MainThread]: On master: BEGIN
[0m00:29:42.008002 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:29:42.009003 [debug] [MainThread]: On master: COMMIT
[0m00:29:42.010003 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:42.011005 [debug] [MainThread]: On master: COMMIT
[0m00:29:42.012007 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:29:42.012007 [debug] [MainThread]: On master: Close
[0m00:29:42.017004 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:29:42.018004 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:29:42.019005 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:29:42.020005 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:29:42.030003 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:29:42.038009 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:29:42.125000 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:29:42.126000 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp002942087000"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-28') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:29:42.126000 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:29:42.186004 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.059 seconds
[0m00:29:42.205006 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:29:42.206004 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:29:42.207004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:29:42.208004 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:29:42.209001 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp002942087000'
        
      order by ordinal_position

  
[0m00:29:42.221003 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m00:29:42.229002 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:29:42.230003 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:29:42.236002 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:29:42.247003 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:29:42.248004 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:29:42.253003 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:29:42.269367 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:29:42.272256 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:29:42.273237 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp002942087000"
    )


  
[0m00:29:42.274804 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.001 seconds
[0m00:29:42.296754 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:29:42.297815 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:29:42.298336 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:29:42.299498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:29:42.303501 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:29:42.305499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5272ce-2e9d-4b93-8403-fc4f0fe2e75d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ABF657260>]}
[0m00:29:42.307499 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 2[0m in 0.29s]
[0m00:29:42.311648 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:29:42.313645 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:42.313645 [debug] [MainThread]: On master: BEGIN
[0m00:29:42.314645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:29:42.374853 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m00:29:42.376050 [debug] [MainThread]: On master: COMMIT
[0m00:29:42.376607 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:42.377216 [debug] [MainThread]: On master: COMMIT
[0m00:29:42.378300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:29:42.378820 [debug] [MainThread]: On master: Close
[0m00:29:42.379915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:42.380445 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:29:42.381431 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:29:42.381431 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:29:42.382743 [info ] [MainThread]: 
[0m00:29:42.383746 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m00:29:42.384637 [debug] [MainThread]: Command end result
[0m00:29:42.429067 [info ] [MainThread]: 
[0m00:29:42.430244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:42.431286 [info ] [MainThread]: 
[0m00:29:42.431958 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:29:42.434082 [debug] [MainThread]: Command `dbt run` succeeded at 00:29:42.434082 after 2.35 seconds
[0m00:29:42.435116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC215B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC3737B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC1F62780>]}
[0m00:29:42.436119 [debug] [MainThread]: Flushing usage events
[0m00:29:43.035070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:30:15.163550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579AC03470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579CE23B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579D4E6A20>]}


============================== 00:30:15.168514 | 26945f70-cf91-42f4-ac67-26513a9cc2ce ==============================
[0m00:30:15.168514 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:30:15.169489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:30:15.458462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26945f70-cf91-42f4-ac67-26513a9cc2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579CE22060>]}
[0m00:30:15.555465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26945f70-cf91-42f4-ac67-26513a9cc2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579D807230>]}
[0m00:30:15.557502 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:30:15.568509 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:30:15.814929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:30:15.815929 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:30:15.857928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26945f70-cf91-42f4-ac67-26513a9cc2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579DCF5D30>]}
[0m00:30:16.003972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26945f70-cf91-42f4-ac67-26513a9cc2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579EE94C20>]}
[0m00:30:16.005971 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:30:16.074974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26945f70-cf91-42f4-ac67-26513a9cc2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579EDB3770>]}
[0m00:30:16.080986 [info ] [MainThread]: 
[0m00:30:16.083979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:30:16.085972 [info ] [MainThread]: 
[0m00:30:16.087973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:30:16.090972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:30:16.243021 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:30:16.244033 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:30:16.245066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:16.303973 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.060 seconds
[0m00:30:16.305972 [debug] [ThreadPool]: On list_qms: Close
[0m00:30:16.310999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:30:16.319970 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:30:16.320970 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:30:16.320970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:16.369606 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m00:30:16.369606 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:30:16.370651 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:30:16.376606 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m00:30:16.378653 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:30:16.379606 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:30:16.388607 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:16.388607 [debug] [MainThread]: On master: BEGIN
[0m00:30:16.389606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:30:16.438605 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m00:30:16.439664 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:16.439664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:30:16.446605 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:30:16.448652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26945f70-cf91-42f4-ac67-26513a9cc2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579F1FA240>]}
[0m00:30:16.449645 [debug] [MainThread]: On master: ROLLBACK
[0m00:30:16.450650 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:16.451644 [debug] [MainThread]: On master: BEGIN
[0m00:30:16.452606 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:30:16.452606 [debug] [MainThread]: On master: COMMIT
[0m00:30:16.453644 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:16.454645 [debug] [MainThread]: On master: COMMIT
[0m00:30:16.454645 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:30:16.455618 [debug] [MainThread]: On master: Close
[0m00:30:16.460620 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:30:16.461661 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:30:16.463621 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:30:16.463621 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:30:16.473646 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:30:16.475609 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:30:16.566608 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:30:16.567613 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:16.568620 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:30:16.569606 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:30:16.622606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m00:30:16.622606 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:16.623605 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
  
    

  create  table "qms"."public"."queue_summary"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-28') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:30:16.634607 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.010 seconds
[0m00:30:16.657607 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:30:16.658607 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:16.659606 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:30:16.661606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:30:16.663605 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:30:16.665607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26945f70-cf91-42f4-ac67-26513a9cc2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579AD36F00>]}
[0m00:30:16.667606 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mSELECT 2[0m in 0.20s]
[0m00:30:16.668606 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:30:16.670607 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:16.671607 [debug] [MainThread]: On master: BEGIN
[0m00:30:16.672606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:30:16.727607 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m00:30:16.728612 [debug] [MainThread]: On master: COMMIT
[0m00:30:16.728612 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:16.729611 [debug] [MainThread]: On master: COMMIT
[0m00:30:16.730611 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:30:16.731609 [debug] [MainThread]: On master: Close
[0m00:30:16.732609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:16.732609 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:30:16.733609 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:30:16.734610 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:30:16.734610 [info ] [MainThread]: 
[0m00:30:16.762608 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m00:30:16.766609 [debug] [MainThread]: Command end result
[0m00:30:16.892608 [info ] [MainThread]: 
[0m00:30:16.902610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:30:16.929607 [info ] [MainThread]: 
[0m00:30:16.947606 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:30:16.961625 [debug] [MainThread]: Command `dbt run` succeeded at 00:30:16.961625 after 2.02 seconds
[0m00:30:16.962607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579D83B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579DA69580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579CE549B0>]}
[0m00:30:16.963608 [debug] [MainThread]: Flushing usage events
[0m00:30:17.504355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:30:25.915461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AE0CE780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AEB019D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AEB00680>]}


============================== 00:30:25.920508 | 8a25f66f-11af-43b5-b800-7e34ffeae418 ==============================
[0m00:30:25.920508 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:30:25.921468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:30:26.192413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a25f66f-11af-43b5-b800-7e34ffeae418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AF0809B0>]}
[0m00:30:26.271421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a25f66f-11af-43b5-b800-7e34ffeae418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AEA253A0>]}
[0m00:30:26.272422 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:30:26.283458 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:30:26.479561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:30:26.480561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:30:26.517524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a25f66f-11af-43b5-b800-7e34ffeae418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AF38A150>]}
[0m00:30:26.619523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a25f66f-11af-43b5-b800-7e34ffeae418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B0544BF0>]}
[0m00:30:26.619523 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:30:26.621541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a25f66f-11af-43b5-b800-7e34ffeae418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B046C440>]}
[0m00:30:26.623559 [info ] [MainThread]: 
[0m00:30:26.624525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:30:26.626588 [info ] [MainThread]: 
[0m00:30:26.627526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:30:26.630527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:30:26.777563 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:30:26.778574 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:30:26.779524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:26.838562 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.059 seconds
[0m00:30:26.840561 [debug] [ThreadPool]: On list_qms: Close
[0m00:30:26.843528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:30:26.851522 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:30:26.852523 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:30:26.853522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:26.901684 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m00:30:26.902735 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:30:26.903718 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:30:26.910696 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m00:30:26.912695 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:30:26.913700 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:30:26.922742 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:26.923696 [debug] [MainThread]: On master: BEGIN
[0m00:30:26.924736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:30:26.981706 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m00:30:26.982714 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:26.983706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:30:26.991706 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:30:26.993706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a25f66f-11af-43b5-b800-7e34ffeae418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B0891D30>]}
[0m00:30:26.994760 [debug] [MainThread]: On master: ROLLBACK
[0m00:30:26.995696 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:26.995696 [debug] [MainThread]: On master: BEGIN
[0m00:30:26.996739 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:30:26.997705 [debug] [MainThread]: On master: COMMIT
[0m00:30:26.998694 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:26.998694 [debug] [MainThread]: On master: COMMIT
[0m00:30:26.999740 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:30:27.000695 [debug] [MainThread]: On master: Close
[0m00:30:27.007696 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:30:27.008707 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:30:27.010708 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:30:27.011746 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:30:27.021710 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:30:27.022696 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:30:27.107741 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:27.108742 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp003027071713"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-28') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:30:27.109705 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:30:27.165707 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.056 seconds
[0m00:30:27.183732 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:27.184732 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:30:27.185721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:30:27.186709 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:27.187716 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp003027071713'
        
      order by ordinal_position

  
[0m00:30:27.199694 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m00:30:27.206732 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:27.207761 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:30:27.212694 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:30:27.222741 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:27.223696 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:30:27.230719 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m00:30:27.250705 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:30:27.251705 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:27.252706 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp003027071713"
    )


  
[0m00:30:27.254695 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.001 seconds
[0m00:30:27.276696 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:30:27.277696 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:30:27.278697 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:30:27.280734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:30:27.282733 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:30:27.285696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a25f66f-11af-43b5-b800-7e34ffeae418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AC417530>]}
[0m00:30:27.286697 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 2[0m in 0.27s]
[0m00:30:27.288699 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:30:27.290697 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:27.290697 [debug] [MainThread]: On master: BEGIN
[0m00:30:27.291697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:30:27.356856 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m00:30:27.357834 [debug] [MainThread]: On master: COMMIT
[0m00:30:27.357834 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:27.358883 [debug] [MainThread]: On master: COMMIT
[0m00:30:27.359832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:30:27.360833 [debug] [MainThread]: On master: Close
[0m00:30:27.361834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:27.361834 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:30:27.362835 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:30:27.363834 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:30:27.363834 [info ] [MainThread]: 
[0m00:30:27.365834 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m00:30:27.367251 [debug] [MainThread]: Command end result
[0m00:30:27.406588 [info ] [MainThread]: 
[0m00:30:27.407601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:30:27.409606 [info ] [MainThread]: 
[0m00:30:27.410591 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:30:27.414590 [debug] [MainThread]: Command `dbt run` succeeded at 00:30:27.413593 after 1.72 seconds
[0m00:30:27.415590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ABAE3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B04B0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AEE28BC0>]}
[0m00:30:27.417590 [debug] [MainThread]: Flushing usage events
[0m00:30:28.335729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:04.696182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8595067E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A856C23710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8593D8AD0>]}


============================== 00:33:04.701220 | 0ceed6a1-be72-4639-8d69-9a3edf7223b3 ==============================
[0m00:33:04.701220 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:33:04.702172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:33:04.983823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ceed6a1-be72-4639-8d69-9a3edf7223b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85985B350>]}
[0m00:33:05.079600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ceed6a1-be72-4639-8d69-9a3edf7223b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85976C470>]}
[0m00:33:05.081837 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:33:05.100474 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:33:05.317768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:05.318728 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:05.353717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ceed6a1-be72-4639-8d69-9a3edf7223b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A859BBEA50>]}
[0m00:33:05.452717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ceed6a1-be72-4639-8d69-9a3edf7223b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85ADF5010>]}
[0m00:33:05.453717 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:33:05.455727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ceed6a1-be72-4639-8d69-9a3edf7223b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A859B7B800>]}
[0m00:33:05.457717 [info ] [MainThread]: 
[0m00:33:05.458741 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:05.460717 [info ] [MainThread]: 
[0m00:33:05.462737 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:33:05.464731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:33:05.612718 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:33:05.614716 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:33:05.615717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:05.680717 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.064 seconds
[0m00:33:05.682715 [debug] [ThreadPool]: On list_qms: Close
[0m00:33:05.684719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:33:05.692715 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:33:05.693715 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:33:05.694731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:05.741716 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m00:33:05.741716 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:33:05.742716 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:33:05.748719 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:33:05.750717 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:33:05.751715 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:33:05.759715 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:05.760715 [debug] [MainThread]: On master: BEGIN
[0m00:33:05.761718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:05.810717 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m00:33:05.811716 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:05.812718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:05.819715 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:33:05.821718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ceed6a1-be72-4639-8d69-9a3edf7223b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A859B50DD0>]}
[0m00:33:05.822718 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:05.823717 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:05.824717 [debug] [MainThread]: On master: BEGIN
[0m00:33:05.825717 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:33:05.826717 [debug] [MainThread]: On master: COMMIT
[0m00:33:05.828272 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:05.829841 [debug] [MainThread]: On master: COMMIT
[0m00:33:05.830837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:33:05.831717 [debug] [MainThread]: On master: Close
[0m00:33:05.835729 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:33:05.836755 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:33:05.838719 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:33:05.839719 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:33:05.848718 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:33:05.849717 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:33:05.936717 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:05.936717 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp003305899717"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-28') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:33:05.938717 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:33:06.109031 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.171 seconds
[0m00:33:06.126072 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:06.127069 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:33:06.129031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:33:06.129031 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:06.130026 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp003305899717'
        
      order by ordinal_position

  
[0m00:33:06.141070 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.010 seconds
[0m00:33:06.148021 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:06.149026 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:33:06.153057 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:33:06.163069 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:06.163069 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:33:06.168070 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:33:06.184067 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:33:06.185047 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:06.186104 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp003305899717"
    )


  
[0m00:33:06.188099 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.001 seconds
[0m00:33:06.210023 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:33:06.211022 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:06.211022 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:33:06.214021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:33:06.217021 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:33:06.223021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ceed6a1-be72-4639-8d69-9a3edf7223b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A856D57380>]}
[0m00:33:06.227021 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 2[0m in 0.38s]
[0m00:33:06.230022 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:33:06.232021 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:06.233034 [debug] [MainThread]: On master: BEGIN
[0m00:33:06.233034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:06.293022 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m00:33:06.294022 [debug] [MainThread]: On master: COMMIT
[0m00:33:06.295021 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:06.296022 [debug] [MainThread]: On master: COMMIT
[0m00:33:06.297020 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:33:06.297020 [debug] [MainThread]: On master: Close
[0m00:33:06.298020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:06.299020 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:33:06.300020 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:33:06.300020 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:33:06.301036 [info ] [MainThread]: 
[0m00:33:06.302021 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m00:33:06.303022 [debug] [MainThread]: Command end result
[0m00:33:06.343020 [info ] [MainThread]: 
[0m00:33:06.345022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:06.346022 [info ] [MainThread]: 
[0m00:33:06.347024 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:33:06.350021 [debug] [MainThread]: Command `dbt run` succeeded at 00:33:06.350021 after 1.86 seconds
[0m00:33:06.351023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85969B8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85B026B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8593D8AD0>]}
[0m00:33:06.352024 [debug] [MainThread]: Flushing usage events
[0m00:33:06.939000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:13.495357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A73B9ABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A714360F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A71CED7C0>]}


============================== 00:33:13.500384 | 7a834a6b-701f-41b0-8a59-396ce9831de2 ==============================
[0m00:33:13.500384 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:33:13.501348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:33:13.793384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a834a6b-701f-41b0-8a59-396ce9831de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A74B502C0>]}
[0m00:33:13.873382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a834a6b-701f-41b0-8a59-396ce9831de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A745CB0B0>]}
[0m00:33:13.875400 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:33:13.887347 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:33:14.102401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:14.102401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:14.143950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a834a6b-701f-41b0-8a59-396ce9831de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A74E251F0>]}
[0m00:33:14.266926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a834a6b-701f-41b0-8a59-396ce9831de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A74FF4D10>]}
[0m00:33:14.267927 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:33:14.269926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a834a6b-701f-41b0-8a59-396ce9831de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A74E58D40>]}
[0m00:33:14.273924 [info ] [MainThread]: 
[0m00:33:14.280926 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:14.292016 [info ] [MainThread]: 
[0m00:33:14.295910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:33:14.297625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:33:14.441183 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:33:14.442181 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:33:14.443185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:14.499181 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.056 seconds
[0m00:33:14.501219 [debug] [ThreadPool]: On list_qms: Close
[0m00:33:14.503187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:33:14.511220 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:33:14.512220 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:33:14.513192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:14.562190 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m00:33:14.562190 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:33:14.563221 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:33:14.569202 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:33:14.571225 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:33:14.572190 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:33:14.580226 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:14.581230 [debug] [MainThread]: On master: BEGIN
[0m00:33:14.582248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:14.739640 [debug] [MainThread]: SQL status: BEGIN in 0.157 seconds
[0m00:33:14.740638 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:14.740638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:14.749654 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:33:14.751591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a834a6b-701f-41b0-8a59-396ce9831de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A74D20A70>]}
[0m00:33:14.752591 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:14.753595 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:14.754594 [debug] [MainThread]: On master: BEGIN
[0m00:33:14.756601 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:33:14.756601 [debug] [MainThread]: On master: COMMIT
[0m00:33:14.757613 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:14.758611 [debug] [MainThread]: On master: COMMIT
[0m00:33:14.758611 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:33:14.759591 [debug] [MainThread]: On master: Close
[0m00:33:14.764590 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:33:14.765634 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:33:14.767592 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:33:14.768592 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:33:14.776591 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:33:14.778590 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:33:14.863590 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:14.864590 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp003314827590"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-28') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-28'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:33:14.865591 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:33:14.926591 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.061 seconds
[0m00:33:14.943638 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:14.944635 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:33:14.946620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:33:14.947635 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:14.948592 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp003314827590'
        
      order by ordinal_position

  
[0m00:33:14.959635 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m00:33:14.966611 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:14.967639 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:33:14.972657 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:33:14.982641 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:14.983591 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:33:14.988635 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:33:15.004656 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:33:15.005637 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:33:15.006626 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp003314827590"
    )


  
[0m00:33:15.011636 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-28) already exists.

[0m00:33:15.012629 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: ROLLBACK
[0m00:33:15.013604 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:33:15.022639 [debug] [Thread-1 (]: Database Error in model queue_summary (models\queue_summary.sql)
  duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
  DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-28) already exists.
  compiled code at target\run\Analytics_ETL_Model\models\queue_summary.sql
[0m00:33:15.024640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a834a6b-701f-41b0-8a59-396ce9831de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A76331AC0>]}
[0m00:33:15.025643 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public.queue_summary ............... [[31mERROR[0m in 0.26s]
[0m00:33:15.027590 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:33:15.028638 [debug] [Thread-4 (]: Marking all children of 'model.Analytics_ETL_Model.queue_summary' to be skipped because of status 'error'.  Reason: Database Error in model queue_summary (models\queue_summary.sql)
  duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
  DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-28) already exists.
  compiled code at target\run\Analytics_ETL_Model\models\queue_summary.sql.
[0m00:33:15.031594 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:15.032610 [debug] [MainThread]: On master: BEGIN
[0m00:33:15.032610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:15.195847 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m00:33:15.195847 [debug] [MainThread]: On master: COMMIT
[0m00:33:15.196900 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:15.197885 [debug] [MainThread]: On master: COMMIT
[0m00:33:15.198847 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:33:15.198847 [debug] [MainThread]: On master: Close
[0m00:33:15.199888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:15.200887 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:33:15.201861 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:33:15.202850 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:33:15.203847 [info ] [MainThread]: 
[0m00:33:15.204848 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m00:33:15.206848 [debug] [MainThread]: Command end result
[0m00:33:15.245847 [info ] [MainThread]: 
[0m00:33:15.246763 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m00:33:15.248773 [info ] [MainThread]: 
[0m00:33:15.250776 [error] [MainThread]:   Database Error in model queue_summary (models\queue_summary.sql)
  duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
  DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-28) already exists.
  compiled code at target\run\Analytics_ETL_Model\models\queue_summary.sql
[0m00:33:15.253789 [info ] [MainThread]: 
[0m00:33:15.255799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:33:15.258838 [debug] [MainThread]: Command `dbt run` failed at 00:33:15.257799 after 1.97 seconds
[0m00:33:15.258838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7479BE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A743DC620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A74AF2330>]}
[0m00:33:15.259820 [debug] [MainThread]: Flushing usage events
[0m00:33:15.795001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:08.638652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DB8275F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DB8266C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DB827920>]}


============================== 00:37:08.643652 | 0ac11772-5330-4770-a5f9-23417044d7f1 ==============================
[0m00:37:08.643652 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:37:08.644653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:37:08.940652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ac11772-5330-4770-a5f9-23417044d7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DBA48FE0>]}
[0m00:37:09.038653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ac11772-5330-4770-a5f9-23417044d7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DB475E20>]}
[0m00:37:09.040653 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:37:09.054652 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:37:09.272690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:37:09.273704 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\config.yml
[0m00:37:09.274719 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\queue_summary.sql
[0m00:37:09.694653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac11772-5330-4770-a5f9-23417044d7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DD26A540>]}
[0m00:37:09.813653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac11772-5330-4770-a5f9-23417044d7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DD2DD4C0>]}
[0m00:37:09.813653 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:37:09.815672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac11772-5330-4770-a5f9-23417044d7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DD2F8530>]}
[0m00:37:09.817692 [info ] [MainThread]: 
[0m00:37:09.819654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:37:09.820700 [info ] [MainThread]: 
[0m00:37:09.822670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:37:09.824663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:37:09.979716 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:37:09.980677 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:37:09.981678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:10.041653 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.059 seconds
[0m00:37:10.043667 [debug] [ThreadPool]: On list_qms: Close
[0m00:37:10.046664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:37:10.055698 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:37:10.056721 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:37:10.057698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:10.107652 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m00:37:10.108698 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:37:10.108698 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:37:10.114696 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:37:10.116690 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:37:10.118662 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:37:10.125695 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:10.126694 [debug] [MainThread]: On master: BEGIN
[0m00:37:10.127693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:10.178655 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m00:37:10.179653 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:10.180668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:37:10.189654 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m00:37:10.191655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac11772-5330-4770-a5f9-23417044d7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DD68C800>]}
[0m00:37:10.192655 [debug] [MainThread]: On master: ROLLBACK
[0m00:37:10.193657 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:10.194653 [debug] [MainThread]: On master: BEGIN
[0m00:37:10.195666 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:37:10.196676 [debug] [MainThread]: On master: COMMIT
[0m00:37:10.197662 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:10.198661 [debug] [MainThread]: On master: COMMIT
[0m00:37:10.199653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:37:10.200653 [debug] [MainThread]: On master: Close
[0m00:37:10.212653 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:37:10.214658 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:37:10.217655 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:37:10.218654 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:37:10.227653 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:37:10.228653 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:37:10.372655 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:10.373654 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp003710278654"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-29') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-29'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:37:10.374654 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:37:10.467653 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.092 seconds
[0m00:37:10.486653 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:10.487652 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:37:10.488653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:37:10.489653 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:10.490653 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp003710278654'
        
      order by ordinal_position

  
[0m00:37:10.501653 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m00:37:10.509652 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:10.510653 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:37:10.515652 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:37:10.525651 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:10.526651 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:37:10.531661 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:37:10.552652 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:37:10.554652 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:10.554652 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp003710278654"
    )


  
[0m00:37:10.556651 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m00:37:10.577654 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:37:10.578655 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:10.579654 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:37:10.580653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:37:10.583655 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:37:10.586655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac11772-5330-4770-a5f9-23417044d7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DD695BE0>]}
[0m00:37:10.587664 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 1[0m in 0.37s]
[0m00:37:10.589654 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:37:10.591653 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:10.591653 [debug] [MainThread]: On master: BEGIN
[0m00:37:10.592653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:37:10.648798 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m00:37:10.649790 [debug] [MainThread]: On master: COMMIT
[0m00:37:10.650792 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:10.651792 [debug] [MainThread]: On master: COMMIT
[0m00:37:10.652901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:37:10.653608 [debug] [MainThread]: On master: Close
[0m00:37:10.654816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:10.655345 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:37:10.656123 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:37:10.656641 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:37:10.657028 [info ] [MainThread]: 
[0m00:37:10.658151 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m00:37:10.659671 [debug] [MainThread]: Command end result
[0m00:37:10.699068 [info ] [MainThread]: 
[0m00:37:10.700063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:37:10.703067 [info ] [MainThread]: 
[0m00:37:10.706155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:37:10.710013 [debug] [MainThread]: Command `dbt run` succeeded at 00:37:10.710013 after 2.29 seconds
[0m00:37:10.711519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DD14E600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DBB42240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183DB9BB800>]}
[0m00:37:10.712787 [debug] [MainThread]: Flushing usage events
[0m00:37:11.368062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:33.535183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA802AECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFDAA4B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80EF9D30>]}


============================== 00:37:33.541196 | f829d4db-23f8-47b9-aee4-6a65c49cf146 ==============================
[0m00:37:33.541196 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:37:33.543828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:37:33.828827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f829d4db-23f8-47b9-aee4-6a65c49cf146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA812A63C0>]}
[0m00:37:33.920829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f829d4db-23f8-47b9-aee4-6a65c49cf146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA806BBB00>]}
[0m00:37:33.925830 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:37:33.940832 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:37:34.174828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:34.175828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:34.212828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f829d4db-23f8-47b9-aee4-6a65c49cf146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA811D3380>]}
[0m00:37:34.321830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f829d4db-23f8-47b9-aee4-6a65c49cf146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA8141DA90>]}
[0m00:37:34.321830 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:37:34.323828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f829d4db-23f8-47b9-aee4-6a65c49cf146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA81499280>]}
[0m00:37:34.325827 [info ] [MainThread]: 
[0m00:37:34.326829 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:37:34.328828 [info ] [MainThread]: 
[0m00:37:34.329831 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:37:34.331830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:37:34.476828 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:37:34.477860 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:37:34.477860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:34.536864 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.058 seconds
[0m00:37:34.538877 [debug] [ThreadPool]: On list_qms: Close
[0m00:37:34.541829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:37:34.549862 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:37:34.549862 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:37:34.550828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:34.600827 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m00:37:34.600827 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:37:34.601827 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:37:34.607827 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:37:34.609828 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:37:34.610828 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:37:34.618825 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:34.619827 [debug] [MainThread]: On master: BEGIN
[0m00:37:34.620828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:34.780996 [debug] [MainThread]: SQL status: BEGIN in 0.161 seconds
[0m00:37:34.782057 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:34.783017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:37:34.791007 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:37:34.792058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f829d4db-23f8-47b9-aee4-6a65c49cf146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA829AE090>]}
[0m00:37:34.793054 [debug] [MainThread]: On master: ROLLBACK
[0m00:37:34.794060 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:34.795032 [debug] [MainThread]: On master: BEGIN
[0m00:37:34.795968 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:37:34.795968 [debug] [MainThread]: On master: COMMIT
[0m00:37:34.796984 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:34.798023 [debug] [MainThread]: On master: COMMIT
[0m00:37:34.798978 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:37:34.798978 [debug] [MainThread]: On master: Close
[0m00:37:34.804003 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:37:34.805033 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:37:34.806981 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:37:34.807980 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:37:34.816979 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:37:34.818993 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:37:34.911018 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:34.912028 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp003734866979"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-29') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-29'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:37:34.913049 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:37:34.971980 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.059 seconds
[0m00:37:34.991033 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:34.991033 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:37:34.992992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:37:34.994040 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:34.994979 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp003734866979'
        
      order by ordinal_position

  
[0m00:37:35.005980 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m00:37:35.013003 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:35.014023 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:37:35.018978 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:37:35.029025 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:35.030026 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:37:35.035027 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:37:35.050978 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:37:35.052983 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:37:35.054010 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp003734866979"
    )


  
[0m00:37:35.056994 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-29) already exists.

[0m00:37:35.057990 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: ROLLBACK
[0m00:37:35.059981 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:37:35.068024 [debug] [Thread-1 (]: Database Error in model queue_summary (models\queue_summary.sql)
  duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
  DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-29) already exists.
  compiled code at target\run\Analytics_ETL_Model\models\queue_summary.sql
[0m00:37:35.070026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f829d4db-23f8-47b9-aee4-6a65c49cf146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA806BA8D0>]}
[0m00:37:35.070979 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public.queue_summary ............... [[31mERROR[0m in 0.26s]
[0m00:37:35.072980 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:37:35.074033 [debug] [Thread-4 (]: Marking all children of 'model.Analytics_ETL_Model.queue_summary' to be skipped because of status 'error'.  Reason: Database Error in model queue_summary (models\queue_summary.sql)
  duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
  DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-29) already exists.
  compiled code at target\run\Analytics_ETL_Model\models\queue_summary.sql.
[0m00:37:35.077018 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:35.077978 [debug] [MainThread]: On master: BEGIN
[0m00:37:35.077978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:37:35.133029 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m00:37:35.133988 [debug] [MainThread]: On master: COMMIT
[0m00:37:35.135016 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:35.136030 [debug] [MainThread]: On master: COMMIT
[0m00:37:35.136993 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:37:35.137980 [debug] [MainThread]: On master: Close
[0m00:37:35.138979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:35.139983 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:37:35.139983 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:37:35.140981 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:37:35.141980 [info ] [MainThread]: 
[0m00:37:35.142987 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m00:37:35.144978 [debug] [MainThread]: Command end result
[0m00:37:35.186992 [info ] [MainThread]: 
[0m00:37:35.188981 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m00:37:35.190981 [info ] [MainThread]: 
[0m00:37:35.192980 [error] [MainThread]:   Database Error in model queue_summary (models\queue_summary.sql)
  duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
  DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-29) already exists.
  compiled code at target\run\Analytics_ETL_Model\models\queue_summary.sql
[0m00:37:35.195980 [info ] [MainThread]: 
[0m00:37:35.197981 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:37:35.202981 [debug] [MainThread]: Command `dbt run` failed at 00:37:35.202981 after 1.88 seconds
[0m00:37:35.204981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA81087290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA806BA8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA808550A0>]}
[0m00:37:35.208017 [debug] [MainThread]: Flushing usage events
[0m00:37:35.688270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:33.075707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC95D7A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9896870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9897E60>]}


============================== 00:38:33.080696 | f460ad42-a02d-4835-bd59-2d2cc71e9cae ==============================
[0m00:38:33.080696 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:38:33.082696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:38:33.366695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f460ad42-a02d-4835-bd59-2d2cc71e9cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9ABC1D0>]}
[0m00:38:33.447746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f460ad42-a02d-4835-bd59-2d2cc71e9cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9455040>]}
[0m00:38:33.448757 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:38:33.461782 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:38:33.679809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:38:33.680812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:38:33.723810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f460ad42-a02d-4835-bd59-2d2cc71e9cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9D48A40>]}
[0m00:38:33.842826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f460ad42-a02d-4835-bd59-2d2cc71e9cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCAF05070>]}
[0m00:38:33.843810 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:38:33.844811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f460ad42-a02d-4835-bd59-2d2cc71e9cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9D67CB0>]}
[0m00:38:33.846816 [info ] [MainThread]: 
[0m00:38:33.848810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:38:33.849812 [info ] [MainThread]: 
[0m00:38:33.850811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:38:33.852833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:38:34.127817 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:38:34.129812 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:38:34.132812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:34.228855 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.098 seconds
[0m00:38:34.230855 [debug] [ThreadPool]: On list_qms: Close
[0m00:38:34.232855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:38:34.241855 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:38:34.242854 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:38:34.243861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:34.292855 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m00:38:34.293857 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:38:34.294857 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:38:34.300855 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m00:38:34.303859 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:38:34.304857 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:38:34.314859 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.314859 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.315855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:34.367858 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m00:38:34.368856 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.369856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:34.378857 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m00:38:34.380855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f460ad42-a02d-4835-bd59-2d2cc71e9cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCB136930>]}
[0m00:38:34.381859 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:34.382856 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.383856 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.384857 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:38:34.385869 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.386855 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.386855 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.387857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:38:34.388857 [debug] [MainThread]: On master: Close
[0m00:38:34.392855 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:38:34.393854 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:38:34.395856 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:38:34.396857 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:38:34.406857 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:38:34.408857 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:38:34.516750 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:38:34.517751 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp003834466855"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-29') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-29'
    GROUP BY queue_id, DATE(join_at)
)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:38:34.517751 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:38:34.581123 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.063 seconds
[0m00:38:34.602516 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:38:34.604103 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:38:34.605765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:38:34.605765 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:38:34.607441 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp003834466855'
        
      order by ordinal_position

  
[0m00:38:34.619847 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.012 seconds
[0m00:38:34.628476 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:38:34.629477 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:38:34.635474 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:38:34.646650 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:38:34.646650 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:38:34.652650 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:38:34.669654 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:38:34.671651 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:38:34.672739 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp003834466855"
    )


  
[0m00:38:34.674735 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.001 seconds
[0m00:38:34.695733 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:38:34.695733 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:38:34.696733 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:38:34.697733 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:38:34.700732 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:38:34.702747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f460ad42-a02d-4835-bd59-2d2cc71e9cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC6E27560>]}
[0m00:38:34.703742 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 2[0m in 0.31s]
[0m00:38:34.705749 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:38:34.707735 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.708733 [debug] [MainThread]: On master: BEGIN
[0m00:38:34.708733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:34.763735 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m00:38:34.764735 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.765734 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:34.765734 [debug] [MainThread]: On master: COMMIT
[0m00:38:34.766734 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:38:34.767736 [debug] [MainThread]: On master: Close
[0m00:38:34.768735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:34.769735 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:38:34.769735 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:38:34.770735 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:38:34.771735 [info ] [MainThread]: 
[0m00:38:34.772735 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m00:38:34.774736 [debug] [MainThread]: Command end result
[0m00:38:34.813734 [info ] [MainThread]: 
[0m00:38:34.814735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:34.815734 [info ] [MainThread]: 
[0m00:38:34.816734 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:38:34.818733 [debug] [MainThread]: Command `dbt run` succeeded at 00:38:34.818733 after 1.95 seconds
[0m00:38:34.819732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9897E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC939DA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC93E4FE0>]}
[0m00:38:34.820733 [debug] [MainThread]: Flushing usage events
[0m00:38:35.355736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:46:59.797906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72CFD7F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C729E59970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72C8EC200>]}


============================== 00:46:59.803866 | b97a7276-08c5-48ca-a147-85fceff9f360 ==============================
[0m00:46:59.803866 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:46:59.804857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:47:00.084856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b97a7276-08c5-48ca-a147-85fceff9f360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72D461CD0>]}
[0m00:47:00.169854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b97a7276-08c5-48ca-a147-85fceff9f360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72D4621E0>]}
[0m00:47:00.171856 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:47:00.183856 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:47:00.386893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:47:00.388881 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\queue_summary.sql
[0m00:47:00.792911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b97a7276-08c5-48ca-a147-85fceff9f360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72E9F6660>]}
[0m00:47:00.901882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b97a7276-08c5-48ca-a147-85fceff9f360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72EAA1520>]}
[0m00:47:00.902857 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:47:00.903857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b97a7276-08c5-48ca-a147-85fceff9f360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72E8DB2C0>]}
[0m00:47:00.906857 [info ] [MainThread]: 
[0m00:47:00.907857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:47:00.908898 [info ] [MainThread]: 
[0m00:47:00.909857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:47:00.911857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:47:01.058892 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:47:01.058892 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:47:01.059866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:01.120858 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.060 seconds
[0m00:47:01.122857 [debug] [ThreadPool]: On list_qms: Close
[0m00:47:01.125857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:47:01.133903 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:47:01.133903 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:47:01.134878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:01.184856 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m00:47:01.185894 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:47:01.186857 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:47:01.192856 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:47:01.194856 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:47:01.195876 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:47:01.204858 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:01.205857 [debug] [MainThread]: On master: BEGIN
[0m00:47:01.206870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:47:01.255856 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m00:47:01.256894 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:01.257892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:47:01.264856 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:47:01.265900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b97a7276-08c5-48ca-a147-85fceff9f360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72E7DE150>]}
[0m00:47:01.266899 [debug] [MainThread]: On master: ROLLBACK
[0m00:47:01.267865 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:01.268856 [debug] [MainThread]: On master: BEGIN
[0m00:47:01.269856 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:47:01.269856 [debug] [MainThread]: On master: COMMIT
[0m00:47:01.270857 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:01.271904 [debug] [MainThread]: On master: COMMIT
[0m00:47:01.272861 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:47:01.272861 [debug] [MainThread]: On master: Close
[0m00:47:01.277866 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:47:01.278871 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:47:01.279873 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:47:01.280892 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:47:01.289903 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:47:01.291857 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:47:01.377856 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:47:01.378880 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp004701338856"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-29') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-29'
    GROUP BY queue_id, DATE(join_at)
)

INSERT INTO queue_summary (queue_id, date, total_reservations)
SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
ON conflict (queue_id, date) DO UPDATE
SET total_reservations = excluded.total_reservations;
  );
  
  
[0m00:47:01.380874 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:47:01.438858 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 23: INSERT INTO queue_summary (queue_id, date, total_reservation...
         ^

[0m00:47:01.439868 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:47:01.447857 [debug] [Thread-1 (]: Database Error in model queue_summary (models\queue_summary.sql)
  syntax error at or near "INSERT"
  LINE 23: INSERT INTO queue_summary (queue_id, date, total_reservation...
           ^
[0m00:47:01.449860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b97a7276-08c5-48ca-a147-85fceff9f360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72C91A9C0>]}
[0m00:47:01.450859 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public.queue_summary ............... [[31mERROR[0m in 0.17s]
[0m00:47:01.452858 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:47:01.453856 [debug] [Thread-4 (]: Marking all children of 'model.Analytics_ETL_Model.queue_summary' to be skipped because of status 'error'.  Reason: Database Error in model queue_summary (models\queue_summary.sql)
  syntax error at or near "INSERT"
  LINE 23: INSERT INTO queue_summary (queue_id, date, total_reservation...
           ^.
[0m00:47:01.456857 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:01.456857 [debug] [MainThread]: On master: BEGIN
[0m00:47:01.457856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:01.520347 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m00:47:01.521347 [debug] [MainThread]: On master: COMMIT
[0m00:47:01.522478 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:01.522994 [debug] [MainThread]: On master: COMMIT
[0m00:47:01.524002 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:47:01.524002 [debug] [MainThread]: On master: Close
[0m00:47:01.525567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:01.526089 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:47:01.527087 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:47:01.527362 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:47:01.527884 [info ] [MainThread]: 
[0m00:47:01.528883 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m00:47:01.531368 [debug] [MainThread]: Command end result
[0m00:47:01.573521 [info ] [MainThread]: 
[0m00:47:01.574579 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m00:47:01.577678 [info ] [MainThread]: 
[0m00:47:01.578732 [error] [MainThread]:   Database Error in model queue_summary (models\queue_summary.sql)
  syntax error at or near "INSERT"
  LINE 23: INSERT INTO queue_summary (queue_id, date, total_reservation...
           ^
[0m00:47:01.579813 [info ] [MainThread]: 
[0m00:47:01.580511 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:47:01.583135 [debug] [MainThread]: Command `dbt run` failed at 00:47:01.583135 after 2.06 seconds
[0m00:47:01.584197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72D0AC950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72D1305C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C72CAB4FE0>]}
[0m00:47:01.584724 [debug] [MainThread]: Flushing usage events
[0m00:47:02.149201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:48.144014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F4078500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F457C7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F47F4C80>]}


============================== 00:51:48.149012 | edb5b9f1-10f6-4a00-8e49-b4c0ca69cbcd ==============================
[0m00:51:48.149012 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:51:48.150012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:51:48.491418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edb5b9f1-10f6-4a00-8e49-b4c0ca69cbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F4FCC530>]}
[0m00:51:48.586301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edb5b9f1-10f6-4a00-8e49-b4c0ca69cbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F4CE1A30>]}
[0m00:51:48.588303 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:51:48.601301 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:51:48.811351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:51:48.813304 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\config.yml
[0m00:51:48.814305 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\queue_summary.sql
[0m00:51:49.245304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edb5b9f1-10f6-4a00-8e49-b4c0ca69cbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F656B440>]}
[0m00:51:49.350304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edb5b9f1-10f6-4a00-8e49-b4c0ca69cbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F66317C0>]}
[0m00:51:49.351304 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:51:49.352303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb5b9f1-10f6-4a00-8e49-b4c0ca69cbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F4AE78C0>]}
[0m00:51:49.355304 [info ] [MainThread]: 
[0m00:51:49.356315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:51:49.357303 [info ] [MainThread]: 
[0m00:51:49.358304 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:51:49.359303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:51:49.513304 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:51:49.514341 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:51:49.515306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:49.578304 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.064 seconds
[0m00:51:49.581346 [debug] [ThreadPool]: On list_qms: Close
[0m00:51:49.583305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:51:49.592307 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:51:49.593308 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:51:49.594323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:49.650318 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m00:51:49.651304 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:51:49.652303 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:51:49.658304 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:51:49.660305 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:51:49.661309 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:51:49.696306 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:49.696306 [debug] [MainThread]: On master: BEGIN
[0m00:51:49.697305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:51:49.816305 [debug] [MainThread]: SQL status: BEGIN in 0.119 seconds
[0m00:51:49.817306 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:49.818306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:51:49.826305 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:51:49.828303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb5b9f1-10f6-4a00-8e49-b4c0ca69cbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F6632900>]}
[0m00:51:49.829305 [debug] [MainThread]: On master: ROLLBACK
[0m00:51:49.830306 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:49.831305 [debug] [MainThread]: On master: BEGIN
[0m00:51:49.832304 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:51:49.832304 [debug] [MainThread]: On master: COMMIT
[0m00:51:49.833306 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:49.834304 [debug] [MainThread]: On master: COMMIT
[0m00:51:49.835303 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:51:49.835303 [debug] [MainThread]: On master: Close
[0m00:51:49.849303 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:51:49.850304 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:51:49.851305 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:51:49.852305 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:51:49.861305 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:51:49.862303 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:51:49.948301 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:51:49.949303 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp005149910305"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-29') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-29'
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:51:49.950303 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:51:50.114328 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.164 seconds
[0m00:51:50.130321 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:51:50.131332 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:51:50.132290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:51:50.133316 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:51:50.134278 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp005149910305'
        
      order by ordinal_position

  
[0m00:51:50.145325 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.010 seconds
[0m00:51:50.153329 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:51:50.153329 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:51:50.158324 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:51:50.168279 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:51:50.169296 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:51:50.174344 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:51:50.189332 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:51:50.191291 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:51:50.192281 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp005149910305"
    )


  
[0m00:51:50.195294 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-29) already exists.

[0m00:51:50.196316 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: ROLLBACK
[0m00:51:50.198311 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:51:50.205325 [debug] [Thread-1 (]: Database Error in model queue_summary (models\queue_summary.sql)
  duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
  DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-29) already exists.
  compiled code at target\run\Analytics_ETL_Model\models\queue_summary.sql
[0m00:51:50.208327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb5b9f1-10f6-4a00-8e49-b4c0ca69cbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F44227B0>]}
[0m00:51:50.210279 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public.queue_summary ............... [[31mERROR[0m in 0.36s]
[0m00:51:50.211279 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:51:50.212290 [debug] [Thread-4 (]: Marking all children of 'model.Analytics_ETL_Model.queue_summary' to be skipped because of status 'error'.  Reason: Database Error in model queue_summary (models\queue_summary.sql)
  duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
  DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-29) already exists.
  compiled code at target\run\Analytics_ETL_Model\models\queue_summary.sql.
[0m00:51:50.216280 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:50.217281 [debug] [MainThread]: On master: BEGIN
[0m00:51:50.217281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:51:50.276280 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m00:51:50.277281 [debug] [MainThread]: On master: COMMIT
[0m00:51:50.277281 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:50.278296 [debug] [MainThread]: On master: COMMIT
[0m00:51:50.279278 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:51:50.280278 [debug] [MainThread]: On master: Close
[0m00:51:50.281278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:50.282280 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:51:50.282280 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:51:50.283280 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:51:50.284279 [info ] [MainThread]: 
[0m00:51:50.285280 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m00:51:50.286289 [debug] [MainThread]: Command end result
[0m00:51:50.328281 [info ] [MainThread]: 
[0m00:51:50.331285 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m00:51:50.333279 [info ] [MainThread]: 
[0m00:51:50.336278 [error] [MainThread]:   Database Error in model queue_summary (models\queue_summary.sql)
  duplicate key value violates unique constraint "queue_summary_queue_id_date_key"
  DETAIL:  Key (queue_id, date)=(077ab504-60fb-4ec4-a87c-e24afb3b9e1a, 2024-10-29) already exists.
  compiled code at target\run\Analytics_ETL_Model\models\queue_summary.sql
[0m00:51:50.337323 [info ] [MainThread]: 
[0m00:51:50.338326 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:51:50.341322 [debug] [MainThread]: Command `dbt run` failed at 00:51:50.341322 after 2.56 seconds
[0m00:51:50.346283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F4C40110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F65B9AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F65B8E30>]}
[0m00:51:50.347331 [debug] [MainThread]: Flushing usage events
[0m00:51:50.905416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:52:46.019134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014984AA34A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014987A06CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014987A04500>]}


============================== 00:52:46.024170 | a8482c56-b21e-4e48-a71f-1e3bf83b0708 ==============================
[0m00:52:46.024170 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:52:46.026136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:52:46.295159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8482c56-b21e-4e48-a71f-1e3bf83b0708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001498806CDA0>]}
[0m00:52:46.374119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8482c56-b21e-4e48-a71f-1e3bf83b0708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001498810B170>]}
[0m00:52:46.375120 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:52:46.387157 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:52:46.625359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:52:46.626360 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\config.yml
[0m00:52:47.044363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8482c56-b21e-4e48-a71f-1e3bf83b0708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014988335DF0>]}
[0m00:52:47.144372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8482c56-b21e-4e48-a71f-1e3bf83b0708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149896B5820>]}
[0m00:52:47.145360 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:52:47.147359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8482c56-b21e-4e48-a71f-1e3bf83b0708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001498964B830>]}
[0m00:52:47.149359 [info ] [MainThread]: 
[0m00:52:47.151369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:52:47.152390 [info ] [MainThread]: 
[0m00:52:47.154367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:52:47.156390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:52:47.302359 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:52:47.303371 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:52:47.304360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:47.365398 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.061 seconds
[0m00:52:47.367395 [debug] [ThreadPool]: On list_qms: Close
[0m00:52:47.369373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:52:47.377359 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:52:47.378359 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:52:47.379368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:47.426375 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m00:52:47.427362 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:52:47.427362 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:52:47.433396 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:52:47.435360 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:52:47.436359 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:52:47.443396 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:47.444427 [debug] [MainThread]: On master: BEGIN
[0m00:52:47.445368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:52:47.495359 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m00:52:47.495359 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:47.496407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:52:47.503397 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:52:47.505371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8482c56-b21e-4e48-a71f-1e3bf83b0708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014989A70A40>]}
[0m00:52:47.506405 [debug] [MainThread]: On master: ROLLBACK
[0m00:52:47.507420 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:47.508405 [debug] [MainThread]: On master: BEGIN
[0m00:52:47.509360 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:52:47.509360 [debug] [MainThread]: On master: COMMIT
[0m00:52:47.510373 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:47.511366 [debug] [MainThread]: On master: COMMIT
[0m00:52:47.512397 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:52:47.513361 [debug] [MainThread]: On master: Close
[0m00:52:47.517359 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:52:47.518358 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:52:47.520371 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:52:47.521359 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:52:47.530415 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:52:47.534361 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:52:47.620383 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:52:47.622382 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp005247582408"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-29') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-29'
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:52:47.622382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:52:47.678359 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.056 seconds
[0m00:52:47.695359 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:52:47.696360 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:52:47.698413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:52:47.699377 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:52:47.699377 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp005247582408'
        
      order by ordinal_position

  
[0m00:52:47.711413 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.010 seconds
[0m00:52:47.718423 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:52:47.719375 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:52:47.724406 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:52:47.735409 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:52:47.736398 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:52:47.741397 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:52:47.762396 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:52:47.764360 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:52:47.765376 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp005247582408"
            where (
                
                    "queue_summary__dbt_tmp005247582408".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp005247582408".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp005247582408"
    )
  
[0m00:52:47.767397 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m00:52:47.789370 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:52:47.790359 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:52:47.791375 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:52:47.794360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:52:47.797364 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:52:47.799361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8482c56-b21e-4e48-a71f-1e3bf83b0708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149853D7080>]}
[0m00:52:47.800362 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.28s]
[0m00:52:47.802360 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:52:47.804360 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:47.805358 [debug] [MainThread]: On master: BEGIN
[0m00:52:47.806358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:52:47.863360 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m00:52:47.864368 [debug] [MainThread]: On master: COMMIT
[0m00:52:47.865369 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:47.866361 [debug] [MainThread]: On master: COMMIT
[0m00:52:47.867360 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:52:47.867360 [debug] [MainThread]: On master: Close
[0m00:52:47.868360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:47.869360 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:52:47.870360 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:52:47.870360 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:52:47.871361 [info ] [MainThread]: 
[0m00:52:47.873363 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m00:52:47.875361 [debug] [MainThread]: Command end result
[0m00:52:47.915359 [info ] [MainThread]: 
[0m00:52:47.917370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:52:47.918375 [info ] [MainThread]: 
[0m00:52:47.919360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:52:47.922369 [debug] [MainThread]: Command `dbt run` succeeded at 00:52:47.921396 after 2.13 seconds
[0m00:52:47.922369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001498759B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149894C9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014987EDB5F0>]}
[0m00:52:47.923397 [debug] [MainThread]: Flushing usage events
[0m00:52:48.485879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:53:32.212365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DD7F6F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DD518FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DD7F72C0>]}


============================== 00:53:32.217394 | 6c70eab2-9dbd-41fc-a927-d42717b57e3b ==============================
[0m00:53:32.217394 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:53:32.218364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:53:32.506126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c70eab2-9dbd-41fc-a927-d42717b57e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DD872E70>]}
[0m00:53:32.609072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c70eab2-9dbd-41fc-a927-d42717b57e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DD845460>]}
[0m00:53:32.611285 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:53:32.625249 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:53:32.856668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:53:32.857669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:53:32.896669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c70eab2-9dbd-41fc-a927-d42717b57e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DD872C60>]}
[0m00:53:33.004670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c70eab2-9dbd-41fc-a927-d42717b57e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DECA4DA0>]}
[0m00:53:33.005687 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:53:33.007670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c70eab2-9dbd-41fc-a927-d42717b57e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DDA74D10>]}
[0m00:53:33.009670 [info ] [MainThread]: 
[0m00:53:33.010670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:53:33.011671 [info ] [MainThread]: 
[0m00:53:33.012670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:53:33.014672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:53:33.183670 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:53:33.184674 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:53:33.185671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:33.250671 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.065 seconds
[0m00:53:33.252671 [debug] [ThreadPool]: On list_qms: Close
[0m00:53:33.254672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:53:33.263670 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:53:33.264670 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:53:33.264670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:33.314669 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m00:53:33.315671 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:53:33.316672 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:53:33.322671 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m00:53:33.324670 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:53:33.325675 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:53:33.334669 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:33.334669 [debug] [MainThread]: On master: BEGIN
[0m00:53:33.335671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:53:33.385671 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m00:53:33.386672 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:33.387672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:53:33.394669 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:53:33.396670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c70eab2-9dbd-41fc-a927-d42717b57e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DEFF0F50>]}
[0m00:53:33.397669 [debug] [MainThread]: On master: ROLLBACK
[0m00:53:33.398671 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:33.399671 [debug] [MainThread]: On master: BEGIN
[0m00:53:33.400671 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:53:33.401673 [debug] [MainThread]: On master: COMMIT
[0m00:53:33.401673 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:33.402672 [debug] [MainThread]: On master: COMMIT
[0m00:53:33.403671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:53:33.403671 [debug] [MainThread]: On master: Close
[0m00:53:33.407671 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:53:33.408671 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:53:33.409670 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:53:33.410672 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:53:33.419671 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:53:33.421671 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:53:33.512668 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:53:33.513670 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp005333475671"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		DATE('2024-10-29') as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = '2024-10-29'
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:53:33.514670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:53:33.568695 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.054 seconds
[0m00:53:33.586708 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:53:33.587684 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:53:33.588718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:53:33.589709 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:53:33.590672 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp005333475671'
        
      order by ordinal_position

  
[0m00:53:33.601684 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.010 seconds
[0m00:53:33.608670 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:53:33.609670 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:53:33.614708 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:53:33.624741 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:53:33.625708 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:53:33.629715 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:53:33.652719 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:53:33.655689 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:53:33.656724 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp005333475671"
            where (
                
                    "queue_summary__dbt_tmp005333475671".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp005333475671".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp005333475671"
    )
  
[0m00:53:33.658720 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m00:53:33.679681 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:53:33.680670 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:53:33.680670 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:53:33.682711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:53:33.684671 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:53:33.687691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c70eab2-9dbd-41fc-a927-d42717b57e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DABD6E70>]}
[0m00:53:33.688722 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.28s]
[0m00:53:33.690673 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:53:33.692683 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:33.693677 [debug] [MainThread]: On master: BEGIN
[0m00:53:33.693677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:53:33.758713 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m00:53:33.759714 [debug] [MainThread]: On master: COMMIT
[0m00:53:33.760717 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:33.760717 [debug] [MainThread]: On master: COMMIT
[0m00:53:33.762671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:53:33.763670 [debug] [MainThread]: On master: Close
[0m00:53:33.764675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:33.764675 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:53:33.765672 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:53:33.766671 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:53:33.767671 [info ] [MainThread]: 
[0m00:53:33.768673 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m00:53:33.770670 [debug] [MainThread]: Command end result
[0m00:53:33.811711 [info ] [MainThread]: 
[0m00:53:33.813680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:53:33.814674 [info ] [MainThread]: 
[0m00:53:33.815675 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:53:33.819676 [debug] [MainThread]: Command `dbt run` succeeded at 00:53:33.818673 after 1.84 seconds
[0m00:53:33.820685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DD6D8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DDB3A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DDB04B90>]}
[0m00:53:33.821710 [debug] [MainThread]: Flushing usage events
[0m00:53:34.655603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:02.678277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853E6C02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853E235940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853E2377A0>]}


============================== 00:55:02.683276 | 7f2fafff-a6e1-44be-89b8-1fe54211b3f4 ==============================
[0m00:55:02.683276 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:55:02.687276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:55:02.985276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f2fafff-a6e1-44be-89b8-1fe54211b3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853E9F02C0>]}
[0m00:55:03.072328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f2fafff-a6e1-44be-89b8-1fe54211b3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853EA4D760>]}
[0m00:55:03.074277 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:55:03.086276 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:55:03.310337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:55:03.311286 [debug] [MainThread]: Partial parsing: updated file: Analytics_ETL_Model://models\queue_summary.sql
[0m00:55:03.795313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f2fafff-a6e1-44be-89b8-1fe54211b3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853FEA3A70>]}
[0m00:55:03.904315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f2fafff-a6e1-44be-89b8-1fe54211b3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018540091340>]}
[0m00:55:03.905315 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:55:03.906314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f2fafff-a6e1-44be-89b8-1fe54211b3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853FECB740>]}
[0m00:55:03.908316 [info ] [MainThread]: 
[0m00:55:03.910314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:03.912315 [info ] [MainThread]: 
[0m00:55:03.914331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:55:03.916316 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:55:04.068357 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:55:04.069353 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:55:04.070330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:04.135353 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.065 seconds
[0m00:55:04.137365 [debug] [ThreadPool]: On list_qms: Close
[0m00:55:04.140315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:55:04.148316 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:55:04.149335 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:55:04.150316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:04.201316 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m00:55:04.203318 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:55:04.203318 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:55:04.210316 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m00:55:04.212320 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:55:04.213319 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:55:04.221366 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:04.222351 [debug] [MainThread]: On master: BEGIN
[0m00:55:04.223317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:04.389678 [debug] [MainThread]: SQL status: BEGIN in 0.167 seconds
[0m00:55:04.390684 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:04.391673 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:55:04.398704 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m00:55:04.401705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f2fafff-a6e1-44be-89b8-1fe54211b3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018540440F20>]}
[0m00:55:04.402655 [debug] [MainThread]: On master: ROLLBACK
[0m00:55:04.402655 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:04.403656 [debug] [MainThread]: On master: BEGIN
[0m00:55:04.405229 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:55:04.406248 [debug] [MainThread]: On master: COMMIT
[0m00:55:04.406248 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:04.407306 [debug] [MainThread]: On master: COMMIT
[0m00:55:04.408239 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:04.408239 [debug] [MainThread]: On master: Close
[0m00:55:04.413244 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:55:04.414239 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:55:04.416254 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:55:04.417241 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:55:04.426240 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:55:04.428241 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:55:04.533301 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:04.534241 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp005504491241"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		CURRENT_DATE  as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = CURRENT_DATE
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:55:04.535279 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:55:04.593240 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.058 seconds
[0m00:55:04.611239 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:04.612239 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:55:04.613240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:55:04.614241 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:04.615239 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp005504491241'
        
      order by ordinal_position

  
[0m00:55:04.627240 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.012 seconds
[0m00:55:04.636238 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:04.637239 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:55:04.642240 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:55:04.652239 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:04.653238 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:55:04.658240 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:55:04.681238 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:55:04.683243 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:04.684241 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp005504491241"
            where (
                
                    "queue_summary__dbt_tmp005504491241".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp005504491241".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp005504491241"
    )
  
[0m00:55:04.686250 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m00:55:04.710240 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:55:04.712239 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:04.713241 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:55:04.716239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:55:04.719241 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:55:04.722240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f2fafff-a6e1-44be-89b8-1fe54211b3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853BDB7110>]}
[0m00:55:04.723241 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.30s]
[0m00:55:04.724244 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:55:04.727239 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:04.727239 [debug] [MainThread]: On master: BEGIN
[0m00:55:04.728240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:04.780240 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m00:55:04.782240 [debug] [MainThread]: On master: COMMIT
[0m00:55:04.783241 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:04.784242 [debug] [MainThread]: On master: COMMIT
[0m00:55:04.785240 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:04.786242 [debug] [MainThread]: On master: Close
[0m00:55:04.786242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:04.787241 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:55:04.788243 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:55:04.788243 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:55:04.789241 [info ] [MainThread]: 
[0m00:55:04.792241 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m00:55:04.794241 [debug] [MainThread]: Command end result
[0m00:55:04.831240 [info ] [MainThread]: 
[0m00:55:04.833239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:04.835244 [info ] [MainThread]: 
[0m00:55:04.837241 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:55:04.843241 [debug] [MainThread]: Command `dbt run` succeeded at 00:55:04.842241 after 2.47 seconds
[0m00:55:04.844242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853E643E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185404EFFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001853BC62C90>]}
[0m00:55:04.844242 [debug] [MainThread]: Flushing usage events
[0m00:55:05.393898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:24.578276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE01FE930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE0727080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE0BDC4D0>]}


============================== 00:55:24.586274 | fa3fc83c-2470-46aa-bd7d-4e4fe97401bc ==============================
[0m00:55:24.586274 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:55:24.587276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:24.880313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa3fc83c-2470-46aa-bd7d-4e4fe97401bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE08EB800>]}
[0m00:55:24.964322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa3fc83c-2470-46aa-bd7d-4e4fe97401bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE120B380>]}
[0m00:55:24.966286 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:55:24.978322 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:55:25.185276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:25.185276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:25.220276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa3fc83c-2470-46aa-bd7d-4e4fe97401bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE143AD80>]}
[0m00:55:25.329286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa3fc83c-2470-46aa-bd7d-4e4fe97401bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE25F4FB0>]}
[0m00:55:25.330320 [info ] [MainThread]: Found 1 model, 428 macros
[0m00:55:25.331325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa3fc83c-2470-46aa-bd7d-4e4fe97401bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE1249280>]}
[0m00:55:25.334321 [info ] [MainThread]: 
[0m00:55:25.335307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:25.337276 [info ] [MainThread]: 
[0m00:55:25.339278 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:55:25.341276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m00:55:25.480275 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m00:55:25.481276 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m00:55:25.482340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:25.638219 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.156 seconds
[0m00:55:25.640221 [debug] [ThreadPool]: On list_qms: Close
[0m00:55:25.643226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m00:55:25.651173 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:55:25.652173 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m00:55:25.652173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:25.704239 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m00:55:25.705176 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m00:55:25.705176 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:55:25.712220 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m00:55:25.714174 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m00:55:25.715173 [debug] [ThreadPool]: On list_qms_public: Close
[0m00:55:25.723219 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:25.725173 [debug] [MainThread]: On master: BEGIN
[0m00:55:25.726173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:25.775514 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m00:55:25.776513 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:25.777513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:55:25.786507 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m00:55:25.787546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa3fc83c-2470-46aa-bd7d-4e4fe97401bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE25146E0>]}
[0m00:55:25.788550 [debug] [MainThread]: On master: ROLLBACK
[0m00:55:25.789532 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:25.790560 [debug] [MainThread]: On master: BEGIN
[0m00:55:25.791545 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:55:25.792575 [debug] [MainThread]: On master: COMMIT
[0m00:55:25.792575 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:25.793561 [debug] [MainThread]: On master: COMMIT
[0m00:55:25.794518 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:25.795508 [debug] [MainThread]: On master: Close
[0m00:55:25.800536 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m00:55:25.801511 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m00:55:25.803880 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m00:55:25.806510 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m00:55:25.821512 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m00:55:25.823510 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m00:55:25.905021 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:25.906033 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp005525869058"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		CURRENT_DATE  as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = CURRENT_DATE
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m00:55:25.907034 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:55:25.964058 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.058 seconds
[0m00:55:25.981064 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:25.982064 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m00:55:25.983024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:55:25.984067 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:25.985026 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp005525869058'
        
      order by ordinal_position

  
[0m00:55:25.996020 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m00:55:26.003057 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:26.003057 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:55:26.009031 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:55:26.018066 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:26.019064 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m00:55:26.024022 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:55:26.048105 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m00:55:26.049105 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:26.050078 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp005525869058"
            where (
                
                    "queue_summary__dbt_tmp005525869058".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp005525869058".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp005525869058"
    )
  
[0m00:55:26.052117 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m00:55:26.071105 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:55:26.072071 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m00:55:26.073069 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m00:55:26.075069 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:55:26.077112 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m00:55:26.080070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa3fc83c-2470-46aa-bd7d-4e4fe97401bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ADE516FF0>]}
[0m00:55:26.082070 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.28s]
[0m00:55:26.085070 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m00:55:26.087069 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:26.088069 [debug] [MainThread]: On master: BEGIN
[0m00:55:26.089068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:26.150077 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m00:55:26.151104 [debug] [MainThread]: On master: COMMIT
[0m00:55:26.152104 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:26.152104 [debug] [MainThread]: On master: COMMIT
[0m00:55:26.153071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:26.154087 [debug] [MainThread]: On master: Close
[0m00:55:26.155068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:26.156070 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m00:55:26.156070 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m00:55:26.157068 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m00:55:26.158077 [info ] [MainThread]: 
[0m00:55:26.159069 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m00:55:26.160069 [debug] [MainThread]: Command end result
[0m00:55:26.202077 [info ] [MainThread]: 
[0m00:55:26.203068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:26.204092 [info ] [MainThread]: 
[0m00:55:26.206071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:55:26.209113 [debug] [MainThread]: Command `dbt run` succeeded at 00:55:26.209113 after 1.87 seconds
[0m00:55:26.210071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE08E9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE0DC3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE14CF710>]}
[0m00:55:26.212071 [debug] [MainThread]: Flushing usage events
[0m00:55:26.700067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:59.222177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD728E4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD6FEE3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD72F87A10>]}


============================== 01:39:59.229367 | 765871cd-2840-4b8e-b504-bd78571de0f5 ==============================
[0m01:39:59.229367 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:39:59.230366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\A_El_Kaimouni\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:39:59.573401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '765871cd-2840-4b8e-b504-bd78571de0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD72FC77D0>]}
[0m01:39:59.666370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '765871cd-2840-4b8e-b504-bd78571de0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD735EC6E0>]}
[0m01:39:59.668411 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:39:59.680402 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:39:59.985386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:39:59.987368 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:40:00.027415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '765871cd-2840-4b8e-b504-bd78571de0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD734B01A0>]}
[0m01:40:00.177369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '765871cd-2840-4b8e-b504-bd78571de0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD736C4CB0>]}
[0m01:40:00.178361 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:40:00.179377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765871cd-2840-4b8e-b504-bd78571de0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD730FBFE0>]}
[0m01:40:00.182422 [info ] [MainThread]: 
[0m01:40:00.183434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:00.185368 [info ] [MainThread]: 
[0m01:40:00.186404 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:40:00.189362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m01:40:00.431384 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m01:40:00.432361 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m01:40:00.433360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:00.522361 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.089 seconds
[0m01:40:00.525364 [debug] [ThreadPool]: On list_qms: Close
[0m01:40:00.527363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m01:40:00.536361 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m01:40:00.538362 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m01:40:00.539362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:00.594361 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m01:40:00.595364 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m01:40:00.595364 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:40:00.603360 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m01:40:00.606362 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m01:40:00.607382 [debug] [ThreadPool]: On list_qms_public: Close
[0m01:40:00.620361 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:00.620361 [debug] [MainThread]: On master: BEGIN
[0m01:40:00.621361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:00.673930 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m01:40:00.674931 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:00.676499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:40:00.687264 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m01:40:00.689546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765871cd-2840-4b8e-b504-bd78571de0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD74BEDCD0>]}
[0m01:40:00.690068 [debug] [MainThread]: On master: ROLLBACK
[0m01:40:00.691071 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:00.692137 [debug] [MainThread]: On master: BEGIN
[0m01:40:00.692975 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:40:00.694035 [debug] [MainThread]: On master: COMMIT
[0m01:40:00.694759 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:00.695280 [debug] [MainThread]: On master: COMMIT
[0m01:40:00.696470 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:40:00.696998 [debug] [MainThread]: On master: Close
[0m01:40:00.701869 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m01:40:00.702931 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m01:40:00.703926 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m01:40:00.704926 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m01:40:00.713927 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m01:40:00.718928 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m01:40:00.813783 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:40:00.814797 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp014000769784"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		CURRENT_DATE  as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = CURRENT_DATE
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m01:40:00.816784 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:00.894788 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.078 seconds
[0m01:40:00.918794 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:40:00.919792 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m01:40:00.922793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m01:40:00.923792 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:40:00.925787 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp014000769784'
        
      order by ordinal_position

  
[0m01:40:00.941788 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.016 seconds
[0m01:40:00.950787 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:40:00.951788 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m01:40:00.956786 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m01:40:00.967787 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:40:00.969788 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m01:40:00.975793 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m01:40:01.001789 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m01:40:01.002786 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:40:01.004789 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp014000769784"
            where (
                
                    "queue_summary__dbt_tmp014000769784".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp014000769784".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp014000769784"
    )
  
[0m01:40:01.007787 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.002 seconds
[0m01:40:01.027787 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m01:40:01.028788 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:40:01.028788 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m01:40:01.030788 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:40:01.033786 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m01:40:01.035788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765871cd-2840-4b8e-b504-bd78571de0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD708170B0>]}
[0m01:40:01.036786 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.33s]
[0m01:40:01.038792 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m01:40:01.040789 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:01.041789 [debug] [MainThread]: On master: BEGIN
[0m01:40:01.042804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:01.100786 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m01:40:01.101787 [debug] [MainThread]: On master: COMMIT
[0m01:40:01.101787 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:01.102787 [debug] [MainThread]: On master: COMMIT
[0m01:40:01.103787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:40:01.104787 [debug] [MainThread]: On master: Close
[0m01:40:01.104787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:01.105791 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m01:40:01.106786 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m01:40:01.107787 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m01:40:01.108788 [info ] [MainThread]: 
[0m01:40:01.110790 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m01:40:01.111789 [debug] [MainThread]: Command end result
[0m01:40:01.154790 [info ] [MainThread]: 
[0m01:40:01.156789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:40:01.158789 [info ] [MainThread]: 
[0m01:40:01.159796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:40:01.163791 [debug] [MainThread]: Command `dbt run` succeeded at 01:40:01.162789 after 2.23 seconds
[0m01:40:01.164790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD73287BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD72D8FCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD73729730>]}
[0m01:40:01.165803 [debug] [MainThread]: Flushing usage events
[0m01:40:01.759622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:48:55.081073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C1507E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C1BC7E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C1BC4830>]}


============================== 01:48:55.087072 | afdb2fe0-4f9d-41ec-9d59-2245c1e60e70 ==============================
[0m01:48:55.087072 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:48:55.088073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:48:55.402375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afdb2fe0-4f9d-41ec-9d59-2245c1e60e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C227BAA0>]}
[0m01:48:55.493373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afdb2fe0-4f9d-41ec-9d59-2245c1e60e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C20744D0>]}
[0m01:48:55.495338 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:48:55.508372 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:48:55.744762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:48:55.745783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:48:55.784756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afdb2fe0-4f9d-41ec-9d59-2245c1e60e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C23A1DC0>]}
[0m01:48:55.906738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afdb2fe0-4f9d-41ec-9d59-2245c1e60e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C2377FB0>]}
[0m01:48:55.907761 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:48:55.908736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afdb2fe0-4f9d-41ec-9d59-2245c1e60e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C232B6B0>]}
[0m01:48:55.909738 [warn ] [MainThread]: The selection criterion 'tag:my_tag' does not match any enabled nodes
[0m01:48:55.912739 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:48:55.914760 [debug] [MainThread]: Command end result
[0m01:48:55.963773 [debug] [MainThread]: Command `cli run` succeeded at 01:48:55.963773 after 1.10 seconds
[0m01:48:55.964776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C1507C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C1EE6DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C22A9EB0>]}
[0m01:48:55.965739 [debug] [MainThread]: Flushing usage events
[0m01:48:56.525301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:48:58.537197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C22A81A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227BF1FFCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C1B945F0>]}


============================== 01:48:58.538260 | 8c893fc8-6704-4620-b1f0-d7776af25be1 ==============================
[0m01:48:58.538260 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:48:58.539877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:48:58.622388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c893fc8-6704-4620-b1f0-d7776af25be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C2120470>]}
[0m01:48:58.627389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c893fc8-6704-4620-b1f0-d7776af25be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C20347A0>]}
[0m01:48:58.628392 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:48:58.642428 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:48:58.777663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:48:58.779667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:48:58.788699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c893fc8-6704-4620-b1f0-d7776af25be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C232A480>]}
[0m01:48:58.825662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c893fc8-6704-4620-b1f0-d7776af25be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C364FE90>]}
[0m01:48:58.826662 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:48:58.827661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c893fc8-6704-4620-b1f0-d7776af25be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C22CCEF0>]}
[0m01:48:58.828674 [warn ] [MainThread]: The selection criterion 'tag:my_tag' does not match any enabled nodes
[0m01:48:58.829673 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:48:58.831663 [debug] [MainThread]: Command end result
[0m01:48:58.869713 [debug] [MainThread]: Command `cli run` succeeded at 01:48:58.869713 after 0.34 seconds
[0m01:48:58.870663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227BF1FFCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C1B96420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C2120470>]}
[0m01:48:58.871673 [debug] [MainThread]: Flushing usage events
[0m01:49:00.605793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:02.617529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227BF344680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C20A0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3549C10>]}


============================== 01:49:02.618530 | 433167c1-d2a1-4891-9440-3348be1ebc60 ==============================
[0m01:49:02.618530 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:49:02.620531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:49:02.709777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '433167c1-d2a1-4891-9440-3348be1ebc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C34548F0>]}
[0m01:49:02.713750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '433167c1-d2a1-4891-9440-3348be1ebc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C34571A0>]}
[0m01:49:02.715731 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:49:02.729774 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:49:02.864017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:02.864550 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:02.876482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '433167c1-d2a1-4891-9440-3348be1ebc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3625490>]}
[0m01:49:02.943518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '433167c1-d2a1-4891-9440-3348be1ebc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C36DBEF0>]}
[0m01:49:02.945521 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:49:02.946520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '433167c1-d2a1-4891-9440-3348be1ebc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C36DBBC0>]}
[0m01:49:02.947520 [warn ] [MainThread]: The selection criterion 'tag:my_tag' does not match any enabled nodes
[0m01:49:02.948519 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:49:02.951520 [debug] [MainThread]: Command end result
[0m01:49:02.997678 [debug] [MainThread]: Command `cli run` succeeded at 01:49:02.997678 after 0.39 seconds
[0m01:49:02.998677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C35C4FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C35C5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C35C5E20>]}
[0m01:49:02.999677 [debug] [MainThread]: Flushing usage events
[0m01:49:03.473633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:05.485995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3650FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3653290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3653470>]}


============================== 01:49:05.486997 | c6bce8e1-f9f5-4b7d-bf2d-ad1bd0f67cdb ==============================
[0m01:49:05.486997 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:49:05.497179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:49:05.584084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6bce8e1-f9f5-4b7d-bf2d-ad1bd0f67cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227BC21FD40>]}
[0m01:49:05.586084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6bce8e1-f9f5-4b7d-bf2d-ad1bd0f67cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227BC21FD40>]}
[0m01:49:05.588085 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:49:05.602084 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:49:05.727084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:05.728096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:05.740123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6bce8e1-f9f5-4b7d-bf2d-ad1bd0f67cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C364DA90>]}
[0m01:49:05.775085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6bce8e1-f9f5-4b7d-bf2d-ad1bd0f67cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3877EF0>]}
[0m01:49:05.776083 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:49:05.778095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6bce8e1-f9f5-4b7d-bf2d-ad1bd0f67cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3877BC0>]}
[0m01:49:05.779085 [warn ] [MainThread]: The selection criterion 'tag:my_tag' does not match any enabled nodes
[0m01:49:05.780084 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:49:05.782084 [debug] [MainThread]: Command end result
[0m01:49:05.818084 [debug] [MainThread]: Command `cli run` succeeded at 01:49:05.818084 after 0.34 seconds
[0m01:49:05.819083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C1534980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C35C5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C35C4080>]}
[0m01:49:05.820083 [debug] [MainThread]: Flushing usage events
[0m01:49:06.329370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:08.342350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C35C77D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C35C4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C35C5E20>]}


============================== 01:49:08.343350 | 71bf0541-9dcc-44c6-bc5c-6a9257653988 ==============================
[0m01:49:08.343350 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:49:08.345351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:49:08.437605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71bf0541-9dcc-44c6-bc5c-6a9257653988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C14B4E90>]}
[0m01:49:08.439600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71bf0541-9dcc-44c6-bc5c-6a9257653988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227BC21FD40>]}
[0m01:49:08.441595 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:49:08.450636 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:49:08.575650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:08.576636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:08.582637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71bf0541-9dcc-44c6-bc5c-6a9257653988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3550380>]}
[0m01:49:08.611589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71bf0541-9dcc-44c6-bc5c-6a9257653988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3947EF0>]}
[0m01:49:08.613590 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:49:08.614590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71bf0541-9dcc-44c6-bc5c-6a9257653988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3947BC0>]}
[0m01:49:08.615591 [warn ] [MainThread]: The selection criterion 'tag:my_tag' does not match any enabled nodes
[0m01:49:08.616999 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:49:08.619009 [debug] [MainThread]: Command end result
[0m01:49:08.709051 [debug] [MainThread]: Command `cli run` succeeded at 01:49:08.708021 after 0.37 seconds
[0m01:49:08.709051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C38640B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3864980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3865760>]}
[0m01:49:08.710010 [debug] [MainThread]: Flushing usage events
[0m01:49:09.208128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:11.218854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3865910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3865280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3866690>]}


============================== 01:49:11.219787 | 4927d847-c9ca-46a9-ad87-049ea06737bb ==============================
[0m01:49:11.219787 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:49:11.222785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:49:11.301833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4927d847-c9ca-46a9-ad87-049ea06737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3867650>]}
[0m01:49:11.304773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4927d847-c9ca-46a9-ad87-049ea06737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227BC21FD40>]}
[0m01:49:11.305775 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:49:11.317820 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:49:11.457842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:11.457842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:11.465873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4927d847-c9ca-46a9-ad87-049ea06737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C36D9310>]}
[0m01:49:11.496822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4927d847-c9ca-46a9-ad87-049ea06737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3542600>]}
[0m01:49:11.498580 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:49:11.500638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4927d847-c9ca-46a9-ad87-049ea06737bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C35438F0>]}
[0m01:49:11.502578 [warn ] [MainThread]: The selection criterion 'tag:my_tag' does not match any enabled nodes
[0m01:49:11.503578 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:49:11.505588 [debug] [MainThread]: Command end result
[0m01:49:11.547577 [debug] [MainThread]: Command `cli run` succeeded at 01:49:11.547577 after 0.33 seconds
[0m01:49:11.548585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C1798200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3876690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C3877440>]}
[0m01:49:11.549616 [debug] [MainThread]: Flushing usage events
[0m01:49:12.062941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:14.073007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C37EFF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C37EF980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C37EC0E0>]}


============================== 01:49:14.074008 | e13cfd71-4248-4946-ad95-10cfe1a79849 ==============================
[0m01:49:14.074008 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:49:14.075997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:49:14.156272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e13cfd71-4248-4946-ad95-10cfe1a79849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C36E6780>]}
[0m01:49:14.159273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e13cfd71-4248-4946-ad95-10cfe1a79849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C36E6C30>]}
[0m01:49:14.160277 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:49:14.171228 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:49:14.294233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:14.295238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:14.302265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e13cfd71-4248-4946-ad95-10cfe1a79849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C378C9E0>]}
[0m01:49:14.334228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e13cfd71-4248-4946-ad95-10cfe1a79849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C2279520>]}
[0m01:49:14.335286 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:49:14.336238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e13cfd71-4248-4946-ad95-10cfe1a79849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C2279AC0>]}
[0m01:49:14.337283 [warn ] [MainThread]: The selection criterion 'tag:my_tag' does not match any enabled nodes
[0m01:49:14.339236 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:49:14.342238 [debug] [MainThread]: Command end result
[0m01:49:14.475229 [debug] [MainThread]: Command `cli run` succeeded at 01:49:14.475229 after 0.41 seconds
[0m01:49:14.476242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C37EC0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C37EFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227C37ECF80>]}
[0m01:49:14.477227 [debug] [MainThread]: Flushing usage events
[0m01:49:14.983828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:35.629401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6A89E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6A89F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6A89E690>]}


============================== 01:49:35.634454 | 9965536e-1d2c-41fe-9bb6-58c71ff0397f ==============================
[0m01:49:35.634454 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:49:35.635391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:49:35.927390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9965536e-1d2c-41fe-9bb6-58c71ff0397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6AD47B90>]}
[0m01:49:36.055455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9965536e-1d2c-41fe-9bb6-58c71ff0397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED681A8320>]}
[0m01:49:36.058304 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:49:36.073583 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:49:36.323429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:36.324430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:36.368431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9965536e-1d2c-41fe-9bb6-58c71ff0397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6A71B140>]}
[0m01:49:36.483444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9965536e-1d2c-41fe-9bb6-58c71ff0397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6C204080>]}
[0m01:49:36.485431 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:49:36.486430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9965536e-1d2c-41fe-9bb6-58c71ff0397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6B0C5BB0>]}
[0m01:49:36.490433 [info ] [MainThread]: 
[0m01:49:36.491430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:49:36.492430 [info ] [MainThread]: 
[0m01:49:36.493444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:49:36.494455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m01:49:36.673431 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m01:49:36.676430 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m01:49:36.677431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:36.733429 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.056 seconds
[0m01:49:36.735431 [debug] [ThreadPool]: On list_qms: Close
[0m01:49:36.738430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m01:49:36.748429 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m01:49:36.749430 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m01:49:36.750430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:36.905849 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m01:49:36.906906 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m01:49:36.907869 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:49:36.918866 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m01:49:36.921863 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m01:49:36.922902 [debug] [ThreadPool]: On list_qms_public: Close
[0m01:49:36.930899 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:36.931905 [debug] [MainThread]: On master: BEGIN
[0m01:49:36.931905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:49:37.093713 [debug] [MainThread]: SQL status: BEGIN in 0.161 seconds
[0m01:49:37.094694 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:37.094694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:49:37.105697 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m01:49:37.108743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9965536e-1d2c-41fe-9bb6-58c71ff0397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6C204EF0>]}
[0m01:49:37.109719 [debug] [MainThread]: On master: ROLLBACK
[0m01:49:37.110695 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:37.110695 [debug] [MainThread]: On master: BEGIN
[0m01:49:37.112705 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:49:37.112705 [debug] [MainThread]: On master: COMMIT
[0m01:49:37.113695 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:37.114733 [debug] [MainThread]: On master: COMMIT
[0m01:49:37.115704 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:49:37.116695 [debug] [MainThread]: On master: Close
[0m01:49:37.120694 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m01:49:37.122694 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m01:49:37.123747 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m01:49:37.124750 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m01:49:37.133693 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m01:49:37.135694 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m01:49:37.228702 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:49:37.229699 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp014937186697"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		CURRENT_DATE  as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = CURRENT_DATE
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m01:49:37.230699 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:49:37.296693 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.066 seconds
[0m01:49:37.321694 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:49:37.322695 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m01:49:37.323694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m01:49:37.324695 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:49:37.325695 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp014937186697'
        
      order by ordinal_position

  
[0m01:49:37.338695 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m01:49:37.345695 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:49:37.346694 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m01:49:37.352695 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m01:49:37.365696 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:49:37.366693 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m01:49:37.371695 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m01:49:37.396694 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m01:49:37.398699 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:49:37.399694 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp014937186697"
            where (
                
                    "queue_summary__dbt_tmp014937186697".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp014937186697".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp014937186697"
    )
  
[0m01:49:37.402698 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.003 seconds
[0m01:49:37.421693 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m01:49:37.422694 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:49:37.423695 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m01:49:37.425704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:49:37.427759 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m01:49:37.430706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9965536e-1d2c-41fe-9bb6-58c71ff0397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED680F6C30>]}
[0m01:49:37.431695 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.31s]
[0m01:49:37.433714 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m01:49:37.435694 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:37.436694 [debug] [MainThread]: On master: BEGIN
[0m01:49:37.436694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:49:37.495696 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m01:49:37.495696 [debug] [MainThread]: On master: COMMIT
[0m01:49:37.496696 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:37.497694 [debug] [MainThread]: On master: COMMIT
[0m01:49:37.497694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:49:37.498695 [debug] [MainThread]: On master: Close
[0m01:49:37.499695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:37.500695 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m01:49:37.501694 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m01:49:37.501694 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m01:49:37.502710 [info ] [MainThread]: 
[0m01:49:37.503698 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m01:49:37.505709 [debug] [MainThread]: Command end result
[0m01:49:37.546693 [info ] [MainThread]: 
[0m01:49:37.548695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:49:37.549695 [info ] [MainThread]: 
[0m01:49:37.550705 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:49:37.553696 [debug] [MainThread]: Command `cli run` succeeded at 01:49:37.553696 after 2.15 seconds
[0m01:49:37.555695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6A6113D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6A790140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6A793C20>]}
[0m01:49:37.556698 [debug] [MainThread]: Flushing usage events
[0m01:49:38.296194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:51:12.729578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B853DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B908D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B8DB1820>]}


============================== 01:51:12.734577 | 437f00d1-7f8f-4518-a905-5cee1ec6532e ==============================
[0m01:51:12.734577 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:51:12.735597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m01:51:13.110314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '437f00d1-7f8f-4518-a905-5cee1ec6532e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B9051640>]}
[0m01:51:13.201522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '437f00d1-7f8f-4518-a905-5cee1ec6532e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B908CA10>]}
[0m01:51:13.206508 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:51:13.223508 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:51:13.449544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:51:13.450506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:51:13.502557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '437f00d1-7f8f-4518-a905-5cee1ec6532e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B8FE5340>]}
[0m01:51:13.615518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '437f00d1-7f8f-4518-a905-5cee1ec6532e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B9725C10>]}
[0m01:51:13.616515 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:51:13.618507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '437f00d1-7f8f-4518-a905-5cee1ec6532e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B9653DD0>]}
[0m01:51:13.620507 [info ] [MainThread]: 
[0m01:51:13.621576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:13.622559 [info ] [MainThread]: 
[0m01:51:13.623577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:51:13.625579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m01:51:13.784568 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m01:51:13.785569 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m01:51:13.786569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:13.848569 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.063 seconds
[0m01:51:13.850569 [debug] [ThreadPool]: On list_qms: Close
[0m01:51:13.853568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m01:51:13.863572 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m01:51:13.865570 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m01:51:13.866570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:13.920569 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m01:51:13.920569 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m01:51:13.921569 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:51:13.928569 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m01:51:13.930570 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m01:51:13.931570 [debug] [ThreadPool]: On list_qms_public: Close
[0m01:51:13.939568 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:13.939568 [debug] [MainThread]: On master: BEGIN
[0m01:51:13.940568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:13.997089 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m01:51:13.998083 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:13.998083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:51:14.006083 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m01:51:14.008083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '437f00d1-7f8f-4518-a905-5cee1ec6532e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7BAC48AD0>]}
[0m01:51:14.009083 [debug] [MainThread]: On master: ROLLBACK
[0m01:51:14.010083 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.010083 [debug] [MainThread]: On master: BEGIN
[0m01:51:14.011084 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:51:14.012084 [debug] [MainThread]: On master: COMMIT
[0m01:51:14.013085 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.014085 [debug] [MainThread]: On master: COMMIT
[0m01:51:14.014085 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:14.015084 [debug] [MainThread]: On master: Close
[0m01:51:14.019084 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m01:51:14.021085 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m01:51:14.023086 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m01:51:14.024083 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m01:51:14.035083 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m01:51:14.041083 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m01:51:14.132083 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:51:14.133082 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp015114092083"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		CURRENT_DATE  as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = CURRENT_DATE
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m01:51:14.134108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:51:14.195085 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.060 seconds
[0m01:51:14.213083 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:51:14.214084 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m01:51:14.215084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m01:51:14.216085 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:51:14.217085 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp015114092083'
        
      order by ordinal_position

  
[0m01:51:14.229085 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m01:51:14.236086 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:51:14.237085 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m01:51:14.242084 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m01:51:14.253085 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:51:14.254085 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m01:51:14.259082 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m01:51:14.286085 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m01:51:14.287084 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:51:14.288085 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp015114092083"
            where (
                
                    "queue_summary__dbt_tmp015114092083".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp015114092083".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp015114092083"
    )
  
[0m01:51:14.291084 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.002 seconds
[0m01:51:14.311082 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m01:51:14.312087 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:51:14.313084 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m01:51:14.315084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:51:14.318085 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m01:51:14.320085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '437f00d1-7f8f-4518-a905-5cee1ec6532e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B8955CA0>]}
[0m01:51:14.321084 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.30s]
[0m01:51:14.323084 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m01:51:14.325084 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.326084 [debug] [MainThread]: On master: BEGIN
[0m01:51:14.326084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:14.384084 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m01:51:14.385085 [debug] [MainThread]: On master: COMMIT
[0m01:51:14.386084 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:14.386084 [debug] [MainThread]: On master: COMMIT
[0m01:51:14.387085 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:51:14.388084 [debug] [MainThread]: On master: Close
[0m01:51:14.389085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:14.390086 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m01:51:14.390086 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m01:51:14.391086 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m01:51:14.392086 [info ] [MainThread]: 
[0m01:51:14.393086 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m01:51:14.394085 [debug] [MainThread]: Command end result
[0m01:51:14.441086 [info ] [MainThread]: 
[0m01:51:14.443086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:51:14.444085 [info ] [MainThread]: 
[0m01:51:14.446084 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:51:14.452100 [debug] [MainThread]: Command `cli run` succeeded at 01:51:14.451088 after 2.04 seconds
[0m01:51:14.453086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B37B6FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B8B8BE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7B8DB3170>]}
[0m01:51:14.454086 [debug] [MainThread]: Flushing usage events
[0m01:52:25.497030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022616074950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226188C5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226188C47A0>]}


============================== 01:52:25.503544 | aba39f1a-b0f9-4f7c-919e-ee7b03c58d1a ==============================
[0m01:52:25.503544 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:52:25.507518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/Users/A_El_Kaimouni/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:52:25.872237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba39f1a-b0f9-4f7c-919e-ee7b03c58d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022618E52D50>]}
[0m01:52:25.980238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aba39f1a-b0f9-4f7c-919e-ee7b03c58d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022618182CC0>]}
[0m01:52:25.982238 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:52:25.996239 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:52:26.222480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:52:26.223481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:52:26.266705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aba39f1a-b0f9-4f7c-919e-ee7b03c58d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022618F831D0>]}
[0m01:52:26.393702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aba39f1a-b0f9-4f7c-919e-ee7b03c58d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002261A1F8530>]}
[0m01:52:26.394668 [info ] [MainThread]: Found 1 model, 428 macros
[0m01:52:26.395668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba39f1a-b0f9-4f7c-919e-ee7b03c58d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022618F2B6B0>]}
[0m01:52:26.397668 [info ] [MainThread]: 
[0m01:52:26.398668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:52:26.399689 [info ] [MainThread]: 
[0m01:52:26.401668 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:52:26.404678 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m01:52:26.581666 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m01:52:26.582670 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m01:52:26.583667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:26.666186 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.083 seconds
[0m01:52:26.668186 [debug] [ThreadPool]: On list_qms: Close
[0m01:52:26.671187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m01:52:26.682203 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m01:52:26.683187 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m01:52:26.684186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:26.738711 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m01:52:26.738711 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m01:52:26.739702 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:52:26.746702 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m01:52:26.749711 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m01:52:26.749711 [debug] [ThreadPool]: On list_qms_public: Close
[0m01:52:26.757702 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:26.757702 [debug] [MainThread]: On master: BEGIN
[0m01:52:26.758701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:26.909479 [debug] [MainThread]: SQL status: BEGIN in 0.151 seconds
[0m01:52:26.910482 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:26.911479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:52:26.919484 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m01:52:26.921481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba39f1a-b0f9-4f7c-919e-ee7b03c58d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022618FD8BF0>]}
[0m01:52:26.922479 [debug] [MainThread]: On master: ROLLBACK
[0m01:52:26.923479 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:26.924481 [debug] [MainThread]: On master: BEGIN
[0m01:52:26.925478 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:52:26.926478 [debug] [MainThread]: On master: COMMIT
[0m01:52:26.926478 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:26.927479 [debug] [MainThread]: On master: COMMIT
[0m01:52:26.928479 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:52:26.928479 [debug] [MainThread]: On master: Close
[0m01:52:26.940478 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m01:52:26.941477 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m01:52:26.943499 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m01:52:26.944487 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m01:52:26.963478 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m01:52:26.965495 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m01:52:27.051476 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:52:27.052487 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp015227013476"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		CURRENT_DATE  as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = CURRENT_DATE
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m01:52:27.053478 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:27.156479 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.104 seconds
[0m01:52:27.174481 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:52:27.175479 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m01:52:27.176480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m01:52:27.177480 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:52:27.178479 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp015227013476'
        
      order by ordinal_position

  
[0m01:52:27.190479 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m01:52:27.197477 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:52:27.198476 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m01:52:27.205485 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m01:52:27.228478 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:52:27.229479 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m01:52:27.234477 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m01:52:27.262479 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m01:52:27.263478 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:52:27.264479 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp015227013476"
            where (
                
                    "queue_summary__dbt_tmp015227013476".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp015227013476".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp015227013476"
    )
  
[0m01:52:27.267479 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m01:52:27.288527 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m01:52:27.289526 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m01:52:27.290502 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m01:52:27.291480 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:52:27.293524 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m01:52:27.296478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba39f1a-b0f9-4f7c-919e-ee7b03c58d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022618235E20>]}
[0m01:52:27.297537 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.35s]
[0m01:52:27.298479 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m01:52:27.301490 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:27.302478 [debug] [MainThread]: On master: BEGIN
[0m01:52:27.302478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:27.368482 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m01:52:27.369539 [debug] [MainThread]: On master: COMMIT
[0m01:52:27.370480 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:27.370480 [debug] [MainThread]: On master: COMMIT
[0m01:52:27.371527 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:52:27.372479 [debug] [MainThread]: On master: Close
[0m01:52:27.373479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:27.374478 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m01:52:27.375477 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m01:52:27.376478 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m01:52:27.377479 [info ] [MainThread]: 
[0m01:52:27.378479 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m01:52:27.380479 [debug] [MainThread]: Command end result
[0m01:52:27.420478 [info ] [MainThread]: 
[0m01:52:27.421489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:52:27.424162 [info ] [MainThread]: 
[0m01:52:27.426461 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:52:27.432111 [debug] [MainThread]: Command `cli run` succeeded at 01:52:27.431534 after 2.20 seconds
[0m01:52:27.433296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022618A891F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226187EF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022618D82C00>]}
[0m01:52:27.433813 [debug] [MainThread]: Flushing usage events
[0m01:52:28.463534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:12.772449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779611970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779ABA5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779ABAB10>]}


============================== 02:03:12.780448 | 0ff5055c-4d9b-4607-8c86-5199f427413e ==============================
[0m02:03:12.780448 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m02:03:12.782445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:03:13.137359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ff5055c-4d9b-4607-8c86-5199f427413e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779DEBEC0>]}
[0m02:03:13.309529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ff5055c-4d9b-4607-8c86-5199f427413e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197792384A0>]}
[0m02:03:13.312522 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:03:13.329520 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m02:03:13.605717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:03:13.606717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:03:13.660717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ff5055c-4d9b-4607-8c86-5199f427413e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779F21B20>]}
[0m02:03:13.813724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ff5055c-4d9b-4607-8c86-5199f427413e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779DE9640>]}
[0m02:03:13.814721 [info ] [MainThread]: Found 1 model, 428 macros
[0m02:03:13.816723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ff5055c-4d9b-4607-8c86-5199f427413e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779F987A0>]}
[0m02:03:13.818750 [info ] [MainThread]: 
[0m02:03:13.820717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:03:13.822743 [info ] [MainThread]: 
[0m02:03:13.824742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:03:13.827720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m02:03:13.987755 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m02:03:13.987755 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m02:03:13.988717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:14.058716 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.069 seconds
[0m02:03:14.060716 [debug] [ThreadPool]: On list_qms: Close
[0m02:03:14.062727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m02:03:14.072716 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m02:03:14.074735 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m02:03:14.075716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:14.130724 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m02:03:14.131780 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m02:03:14.132719 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:03:14.140735 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m02:03:14.142716 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m02:03:14.143714 [debug] [ThreadPool]: On list_qms_public: Close
[0m02:03:14.151760 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:14.152717 [debug] [MainThread]: On master: BEGIN
[0m02:03:14.154723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:14.212721 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m02:03:14.213716 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:14.214722 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:03:14.223716 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m02:03:14.225716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ff5055c-4d9b-4607-8c86-5199f427413e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779F213D0>]}
[0m02:03:14.226715 [debug] [MainThread]: On master: ROLLBACK
[0m02:03:14.227717 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:14.228717 [debug] [MainThread]: On master: BEGIN
[0m02:03:14.229719 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:03:14.229719 [debug] [MainThread]: On master: COMMIT
[0m02:03:14.230717 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:14.231731 [debug] [MainThread]: On master: COMMIT
[0m02:03:14.232718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:03:14.232718 [debug] [MainThread]: On master: Close
[0m02:03:14.237717 [debug] [Thread-1 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m02:03:14.238718 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m02:03:14.239716 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m02:03:14.240719 [debug] [Thread-1 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m02:03:14.250716 [debug] [Thread-1 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m02:03:14.251716 [debug] [Thread-1 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m02:03:14.353778 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:14.354728 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp020314313716"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		CURRENT_DATE  as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = CURRENT_DATE
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m02:03:14.355753 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:03:14.421781 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.066 seconds
[0m02:03:14.440717 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:14.441801 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m02:03:14.442783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m02:03:14.443754 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:14.444741 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp020314313716'
        
      order by ordinal_position

  
[0m02:03:14.457754 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.012 seconds
[0m02:03:14.465755 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:14.466717 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m02:03:14.471767 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m02:03:14.481755 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:14.482753 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m02:03:14.487716 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m02:03:14.512764 [debug] [Thread-1 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m02:03:14.514731 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:14.515763 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp020314313716"
            where (
                
                    "queue_summary__dbt_tmp020314313716".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp020314313716".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp020314313716"
    )
  
[0m02:03:14.518771 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.002 seconds
[0m02:03:14.536729 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m02:03:14.537756 [debug] [Thread-1 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:14.538716 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m02:03:14.540731 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:03:14.542762 [debug] [Thread-1 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m02:03:14.545717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ff5055c-4d9b-4607-8c86-5199f427413e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197790A6150>]}
[0m02:03:14.546754 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.30s]
[0m02:03:14.548717 [debug] [Thread-1 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m02:03:14.550727 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:14.551720 [debug] [MainThread]: On master: BEGIN
[0m02:03:14.552770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:03:14.609779 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m02:03:14.609779 [debug] [MainThread]: On master: COMMIT
[0m02:03:14.610716 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:14.611732 [debug] [MainThread]: On master: COMMIT
[0m02:03:14.612718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:03:14.612718 [debug] [MainThread]: On master: Close
[0m02:03:14.613717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:14.614718 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m02:03:14.615718 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m02:03:14.616718 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m02:03:14.617716 [info ] [MainThread]: 
[0m02:03:14.618717 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m02:03:14.620717 [debug] [MainThread]: Command end result
[0m02:03:14.659727 [info ] [MainThread]: 
[0m02:03:14.660756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:14.662717 [info ] [MainThread]: 
[0m02:03:14.663724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:03:14.667758 [debug] [MainThread]: Command `cli run` succeeded at 02:03:14.667758 after 2.20 seconds
[0m02:03:14.668717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779BD70B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779E19DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977959D7C0>]}
[0m02:03:14.669725 [debug] [MainThread]: Flushing usage events
[0m02:03:15.345865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:17.387378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977647D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019778C1F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197791587D0>]}


============================== 02:03:17.403380 | 463e90f1-d2aa-4763-beb7-02e28119580d ==============================
[0m02:03:17.403380 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m02:03:17.451378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'debug': 'False', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:03:17.700134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '463e90f1-d2aa-4763-beb7-02e28119580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977B837380>]}
[0m02:03:17.703133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '463e90f1-d2aa-4763-beb7-02e28119580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779BD7740>]}
[0m02:03:17.705133 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:03:17.718135 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m02:03:17.958087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:03:17.959084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:03:17.967581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '463e90f1-d2aa-4763-beb7-02e28119580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977B837CE0>]}
[0m02:03:18.004559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '463e90f1-d2aa-4763-beb7-02e28119580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977B8F3EF0>]}
[0m02:03:18.005743 [info ] [MainThread]: Found 1 model, 428 macros
[0m02:03:18.009170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463e90f1-d2aa-4763-beb7-02e28119580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977B8F3BC0>]}
[0m02:03:18.014168 [info ] [MainThread]: 
[0m02:03:18.015841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:03:18.017357 [info ] [MainThread]: 
[0m02:03:18.020586 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:03:18.023412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms'
[0m02:03:18.027459 [debug] [ThreadPool]: Using postgres connection "list_qms"
[0m02:03:18.029460 [debug] [ThreadPool]: On list_qms: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms"} */

    select distinct nspname from pg_namespace
  
[0m02:03:18.030458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:18.090459 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.060 seconds
[0m02:03:18.092458 [debug] [ThreadPool]: On list_qms: Close
[0m02:03:18.095460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_qms_public'
[0m02:03:18.099458 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m02:03:18.100459 [debug] [ThreadPool]: On list_qms_public: BEGIN
[0m02:03:18.101459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:18.169459 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m02:03:18.170460 [debug] [ThreadPool]: Using postgres connection "list_qms_public"
[0m02:03:18.171460 [debug] [ThreadPool]: On list_qms_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "list_qms_public"} */
select
      'qms' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'qms' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:03:18.179463 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m02:03:18.182477 [debug] [ThreadPool]: On list_qms_public: ROLLBACK
[0m02:03:18.183459 [debug] [ThreadPool]: On list_qms_public: Close
[0m02:03:18.189459 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:18.190460 [debug] [MainThread]: On master: BEGIN
[0m02:03:18.192467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:18.257460 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m02:03:18.257460 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:18.258460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:03:18.267456 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m02:03:18.269458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463e90f1-d2aa-4763-beb7-02e28119580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977B863590>]}
[0m02:03:18.270459 [debug] [MainThread]: On master: ROLLBACK
[0m02:03:18.271457 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:18.272460 [debug] [MainThread]: On master: BEGIN
[0m02:03:18.273460 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:03:18.274460 [debug] [MainThread]: On master: COMMIT
[0m02:03:18.275463 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:18.276458 [debug] [MainThread]: On master: COMMIT
[0m02:03:18.279459 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:03:18.280459 [debug] [MainThread]: On master: Close
[0m02:03:18.285459 [debug] [Thread-5 (]: Began running node model.Analytics_ETL_Model.queue_summary
[0m02:03:18.287457 [info ] [Thread-5 (]: 1 of 1 START sql incremental model public.queue_summary ........................ [RUN]
[0m02:03:18.288459 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.Analytics_ETL_Model.queue_summary'
[0m02:03:18.289460 [debug] [Thread-5 (]: Began compiling node model.Analytics_ETL_Model.queue_summary
[0m02:03:18.292458 [debug] [Thread-5 (]: Writing injected SQL for node "model.Analytics_ETL_Model.queue_summary"
[0m02:03:18.295459 [debug] [Thread-5 (]: Began executing node model.Analytics_ETL_Model.queue_summary
[0m02:03:18.308460 [debug] [Thread-5 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:18.309459 [debug] [Thread-5 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

    
  
    

  create temporary table "queue_summary__dbt_tmp020318300461"
  
  
    as
  
  (
    WITH daily_reservations AS (
    SELECT
        queue_id,
		CURRENT_DATE  as date,
        COUNT(id) AS reservation_count
    FROM reservation
	WHERE DATE(join_at) = CURRENT_DATE
    GROUP BY queue_id, DATE(join_at)
)

SELECT
    queue_id,
	date,
    SUM(reservation_count) AS total_reservations
FROM daily_reservations
GROUP BY queue_id, date
  );
  
  
[0m02:03:18.313460 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m02:03:18.472604 [debug] [Thread-5 (]: SQL status: SELECT 3 in 0.159 seconds
[0m02:03:18.476588 [debug] [Thread-5 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:18.477588 [debug] [Thread-5 (]: On model.Analytics_ETL_Model.queue_summary: BEGIN
[0m02:03:18.478598 [debug] [Thread-5 (]: SQL status: BEGIN in 0.001 seconds
[0m02:03:18.479635 [debug] [Thread-5 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:18.480589 [debug] [Thread-5 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary__dbt_tmp020318300461'
        
      order by ordinal_position

  
[0m02:03:18.492587 [debug] [Thread-5 (]: SQL status: SELECT 3 in 0.011 seconds
[0m02:03:18.496588 [debug] [Thread-5 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:18.497589 [debug] [Thread-5 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m02:03:18.503588 [debug] [Thread-5 (]: SQL status: SELECT 3 in 0.005 seconds
[0m02:03:18.508586 [debug] [Thread-5 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:18.508586 [debug] [Thread-5 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "qms".INFORMATION_SCHEMA.columns
      where table_name = 'queue_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m02:03:18.514588 [debug] [Thread-5 (]: SQL status: SELECT 3 in 0.005 seconds
[0m02:03:18.518588 [debug] [Thread-5 (]: Writing runtime sql for node "model.Analytics_ETL_Model.queue_summary"
[0m02:03:18.519591 [debug] [Thread-5 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:18.520589 [debug] [Thread-5 (]: On model.Analytics_ETL_Model.queue_summary: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "Analytics_ETL_Model", "target_name": "dev", "node_id": "model.Analytics_ETL_Model.queue_summary"} */

      
        
            delete from "qms"."public"."queue_summary"
            using "queue_summary__dbt_tmp020318300461"
            where (
                
                    "queue_summary__dbt_tmp020318300461".queue_id = "qms"."public"."queue_summary".queue_id
                    and 
                
                    "queue_summary__dbt_tmp020318300461".date = "qms"."public"."queue_summary".date
                    
                
                
            );
        
    

    insert into "qms"."public"."queue_summary" ("queue_id", "date", "total_reservations")
    (
        select "queue_id", "date", "total_reservations"
        from "queue_summary__dbt_tmp020318300461"
    )
  
[0m02:03:18.522588 [debug] [Thread-5 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m02:03:18.524588 [debug] [Thread-5 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m02:03:18.525588 [debug] [Thread-5 (]: Using postgres connection "model.Analytics_ETL_Model.queue_summary"
[0m02:03:18.526599 [debug] [Thread-5 (]: On model.Analytics_ETL_Model.queue_summary: COMMIT
[0m02:03:18.527588 [debug] [Thread-5 (]: SQL status: COMMIT in 0.001 seconds
[0m02:03:18.529589 [debug] [Thread-5 (]: On model.Analytics_ETL_Model.queue_summary: Close
[0m02:03:18.529589 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463e90f1-d2aa-4763-beb7-02e28119580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977B98A7B0>]}
[0m02:03:18.531590 [info ] [Thread-5 (]: 1 of 1 OK created sql incremental model public.queue_summary ................... [[32mINSERT 0 3[0m in 0.24s]
[0m02:03:18.533590 [debug] [Thread-5 (]: Finished running node model.Analytics_ETL_Model.queue_summary
[0m02:03:18.536591 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:18.537590 [debug] [MainThread]: On master: BEGIN
[0m02:03:18.538589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:03:18.708595 [debug] [MainThread]: SQL status: BEGIN in 0.170 seconds
[0m02:03:18.710591 [debug] [MainThread]: On master: COMMIT
[0m02:03:18.711590 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:18.711590 [debug] [MainThread]: On master: COMMIT
[0m02:03:18.712595 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:03:18.713591 [debug] [MainThread]: On master: Close
[0m02:03:18.714594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:18.715592 [debug] [MainThread]: Connection 'list_qms' was properly closed.
[0m02:03:18.716589 [debug] [MainThread]: Connection 'list_qms_public' was properly closed.
[0m02:03:18.716589 [debug] [MainThread]: Connection 'model.Analytics_ETL_Model.queue_summary' was properly closed.
[0m02:03:18.717590 [info ] [MainThread]: 
[0m02:03:18.718589 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m02:03:18.720590 [debug] [MainThread]: Command end result
[0m02:03:18.755588 [info ] [MainThread]: 
[0m02:03:18.756607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:18.758606 [info ] [MainThread]: 
[0m02:03:18.759601 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:03:18.763597 [debug] [MainThread]: Command `cli run` succeeded at 02:03:18.762589 after 1.39 seconds
[0m02:03:18.764589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977647D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779BD7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019779158860>]}
[0m02:03:18.765634 [debug] [MainThread]: Flushing usage events
[0m02:03:19.283576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:34.194662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108CA9A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108CA9B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108CA99F40>]}


============================== 02:03:34.200542 | ca25317a-b46a-4b03-8a1e-6ee622c56df9 ==============================
[0m02:03:34.200542 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m02:03:34.202540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\A_El_Kaimouni\\Documents\\Web\\QMS\\QMS-Analytics-ETL-Model\\Analytics_ETL_Model\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:03:34.206542 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'Analytics_ETL_Model'
[0m02:03:34.209539 [debug] [MainThread]: Command `cli run` failed at 02:03:34.209539 after 0.31 seconds
[0m02:03:34.209539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108CABE120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108CA99A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108CA99D00>]}
[0m02:03:34.210538 [debug] [MainThread]: Flushing usage events
[0m02:03:34.697220 [debug] [MainThread]: An error was encountered while trying to flush usage events
